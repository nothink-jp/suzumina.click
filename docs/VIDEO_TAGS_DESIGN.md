# VIDEO_TAGS_DESIGN

> **ğŸ“… æœ€çµ‚æ›´æ–°**: 2025å¹´7æœˆ17æ—¥  
> **ğŸ“ ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹**: Phase 3å®Œäº† - 3å±¤ã‚¿ã‚°ã‚·ã‚¹ãƒ†ãƒ UIå®Ÿè£…å®Œäº†  
> **ğŸ”§ å¯¾è±¡**: videosã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã¸ã®ã‚¿ã‚°æ©Ÿèƒ½å®Ÿè£…  
> **ğŸ†• æ›´æ–°å†…å®¹**: Phase 1-3å®Ÿè£…å®Œäº†ã€3å±¤ã‚¿ã‚°è¡¨ç¤ºã‚·ã‚¹ãƒ†ãƒ ç¨¼åƒé–‹å§‹

## æ¦‚è¦

videosã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã«3å±¤ã‚¿ã‚°ã‚·ã‚¹ãƒ†ãƒ ã‚’å®Ÿè£…ã™ã‚‹ãŸã‚ã®è¨­è¨ˆæ–‡æ›¸

### 3å±¤ã‚¿ã‚°ã‚·ã‚¹ãƒ†ãƒ 

1. **è‡ªå‹•ã‚¿ã‚°ï¼ˆãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆãƒ™ãƒ¼ã‚¹ï¼‰** - YouTube ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆã‹ã‚‰è‡ªå‹•ç”Ÿæˆ
2. **è‡ªå‹•ã‚¿ã‚°ï¼ˆã‚«ãƒ†ã‚´ãƒªIDï¼‰** - YouTube ã‚«ãƒ†ã‚´ãƒªIDã‹ã‚‰è‡ªå‹•ç”Ÿæˆ  
3. **æ‰‹å‹•ã‚¿ã‚°ï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼ç·¨é›†å¯èƒ½ï¼‰** - ç™»éŒ²ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒè‡ªç”±ã«ç·¨é›†

## ã‚¿ã‚°ãƒ‡ãƒ¼ã‚¿æ§‹é€ è¨­è¨ˆ

### videosã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã®æ‹¡å¼µ

#### è¿½åŠ ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰

```typescript
interface VideoDocument {
  // ... æ—¢å­˜ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰
  
  // ã€3å±¤ã‚¿ã‚°ã‚·ã‚¹ãƒ†ãƒ ã€‘
  
  // 1. è‡ªå‹•ã‚¿ã‚°ï¼ˆãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆãƒ™ãƒ¼ã‚¹ï¼‰- æ–°è¦è¿½åŠ 
  playlistTags?: string[];           // YouTubeãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆåã‹ã‚‰è‡ªå‹•ç”Ÿæˆ
  
  // 2. è‡ªå‹•ã‚¿ã‚°ï¼ˆã‚«ãƒ†ã‚´ãƒªIDï¼‰- æ—¢å­˜ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’æ´»ç”¨
  categoryId?: string;               // YouTubeæŠ•ç¨¿è€…ãŒé¸æŠã—ãŸã‚«ãƒ†ã‚´ãƒªï¼ˆæ•°å€¤IDï¼‰
  
  // 3. æ‰‹å‹•ã‚¿ã‚°ï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼ç·¨é›†å¯èƒ½ï¼‰- æ–°è¦è¿½åŠ 
  userTags: string[];                // ç™»éŒ²ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒç·¨é›†å¯èƒ½ãªã‚¿ã‚°é…åˆ—
}
```

### ã‚¿ã‚°åˆ¶ç´„

#### ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆã‚¿ã‚°åˆ¶ç´„

```typescript
// è‡ªå‹•ç”Ÿæˆã®ãŸã‚åˆ¶ç´„ã¯æœ€å°é™
playlistTags: z
  .array(z.string().min(1).max(50))  // ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆåã¯é•·ã„å ´åˆãŒã‚ã‚‹ãŸã‚50æ–‡å­—
  .max(20, {                         // æœ€å¤§20å€‹ã®ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆã¾ã§
    message: "ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆã‚¿ã‚°ã¯æœ€å¤§20å€‹ã¾ã§",
  })
  .optional()
  .default([]),
```

#### ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¿ã‚°åˆ¶ç´„ï¼ˆéŸ³å£°ãƒœã‚¿ãƒ³ã¨åŒã˜ï¼‰

```typescript
// shared-types/src/video.ts ã«è¿½åŠ 
userTags: z
  .array(z.string().min(1).max(30))
  .max(15, {
    message: "ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¿ã‚°ã¯æœ€å¤§15å€‹ã¾ã§è¨­å®šã§ãã¾ã™",
  })
  .default([]),
```


### ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆã‚¿ã‚°å®Ÿè£…

#### æ—¢å­˜fetchYoutubeVideosé–¢æ•°ã¨ã®çµ±åˆ

```typescript
// apps/functions/src/services/youtube/youtube-api.ts ã¸ã®è¿½åŠ 

/**
 * ãƒãƒ£ãƒ³ãƒãƒ«ã®ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆä¸€è¦§ã‚’å–å¾—
 * æ—¢å­˜ã®ã‚¯ã‚©ãƒ¼ã‚¿ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ ã‚’æ´»ç”¨
 */
export async function fetchChannelPlaylists(
  youtube: youtube_v3.Youtube,
  channelId: string,
): Promise<PlaylistInfo[]> {
  // ã‚¯ã‚©ãƒ¼ã‚¿ãƒã‚§ãƒƒã‚¯
  if (!canExecuteOperation("playlists")) {
    throw new Error("YouTube APIã‚¯ã‚©ãƒ¼ã‚¿ãŒä¸è¶³ã—ã¦ã„ã¾ã™");
  }

  try {
    const response = await youtube.playlists.list({
      part: ["snippet", "contentDetails"],
      channelId: channelId,
      maxResults: 50,
    });

    // æˆåŠŸæ™‚ã«ã‚¯ã‚©ãƒ¼ã‚¿ä½¿ç”¨é‡ã‚’è¨˜éŒ²
    recordQuotaUsage("playlists");
    getYouTubeQuotaMonitor().logQuotaUsage("playlists", 1, {
      channelId,
      resultCount: response.data.items?.length || 0,
    });

    return (
      response.data.items?.map((playlist) => ({
        id: playlist.id || "",
        title: playlist.snippet?.title || "",
        videoCount: playlist.contentDetails?.itemCount || 0,
        description: playlist.snippet?.description || "",
        publishedAt: playlist.snippet?.publishedAt || "",
      })) || []
    );
  } catch (error: unknown) {
    logger.error("ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆå–å¾—ã‚¨ãƒ©ãƒ¼:", error);
    throw error;
  }
}

/**
 * ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆã®å‹•ç”»ä¸€è¦§ã‚’å–å¾—
 * æ—¢å­˜ã®ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³å‡¦ç†ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’æ´»ç”¨
 */
export async function fetchPlaylistItems(
  youtube: youtube_v3.Youtube,
  playlistId: string,
): Promise<string[]> {
  const videoIds: string[] = [];
  let nextPageToken: string | undefined;
  let pageCount = 0;

  do {
    // ã‚¯ã‚©ãƒ¼ã‚¿ãƒã‚§ãƒƒã‚¯
    if (!canExecuteOperation("playlistItems")) {
      logger.warn("ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆã‚¢ã‚¤ãƒ†ãƒ å–å¾—ã§ã‚¯ã‚©ãƒ¼ã‚¿ä¸è¶³", {
        playlistId,
        pageCount,
        currentVideoIds: videoIds.length,
      });
      break;
    }

    try {
      const response = await youtube.playlistItems.list({
        part: ["contentDetails"],
        playlistId: playlistId,
        maxResults: MAX_VIDEOS_PER_BATCH, // æ—¢å­˜ã®å®šæ•°ã‚’æ´»ç”¨
        pageToken: nextPageToken,
      });

      // æˆåŠŸæ™‚ã«ã‚¯ã‚©ãƒ¼ã‚¿ä½¿ç”¨é‡ã‚’è¨˜éŒ²
      recordQuotaUsage("playlistItems");
      getYouTubeQuotaMonitor().logQuotaUsage("playlistItems", 1, {
        playlistId,
        pageNumber: pageCount + 1,
        resultCount: response.data.items?.length || 0,
      });

      const items = response.data.items || [];
      const batchVideoIds = items
        .map((item) => item.contentDetails?.videoId)
        .filter((id): id is string => !!id);

      videoIds.push(...batchVideoIds);
      nextPageToken = response.data.nextPageToken;
      pageCount++;

      logger.debug(`ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆ ${playlistId} ãƒšãƒ¼ã‚¸ ${pageCount}: ${batchVideoIds.length}ä»¶å–å¾—`);
    } catch (error: unknown) {
      logger.error("ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆã‚¢ã‚¤ãƒ†ãƒ å–å¾—ã‚¨ãƒ©ãƒ¼:", error);
      break;
    }
  } while (nextPageToken);

  logger.info(`ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆ ${playlistId} ç·å–å¾—å‹•ç”»æ•°: ${videoIds.length}ä»¶`);
  return videoIds;
}

// å‹å®šç¾©ã®è¿½åŠ 
interface PlaylistInfo {
  id: string;
  title: string;
  videoCount: number;
  description: string;
  publishedAt: string;
}

interface PlaylistVideoMapping {
  videoId: string;
  playlistTitles: string[];
}
```

#### ã‚¯ã‚©ãƒ¼ã‚¿ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ ã®æ‹¡å¼µ

```typescript
// apps/functions/src/infrastructure/monitoring/youtube-quota-monitor.ts ã¸ã®è¿½åŠ 

export const QUOTA_COSTS = {
  // æ—¢å­˜ã®å®šç¾©...
  search: 100,
  videosFullDetails: 8,
  
  // ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆé–¢é€£ã®è¿½åŠ 
  playlists: 1,           // playlists.list
  playlistItems: 1,       // playlistItems.list
} as const;
```

### YouTubeã‚«ãƒ†ã‚´ãƒªIDæ´»ç”¨

```typescript
// æ—¢å­˜ãƒ‡ãƒ¼ã‚¿ã®æ´»ç”¨ï¼ˆå®Ÿè£…æ¸ˆã¿ï¼‰- æ—¥æœ¬èªåŒ–å¯¾å¿œ
const YOUTUBE_CATEGORIES = {
  "1": "æ˜ ç”»ãƒ»ã‚¢ãƒ‹ãƒ¡",              // Film & Animation
  "2": "è‡ªå‹•è»Šãƒ»ä¹—ã‚Šç‰©",            // Autos & Vehicles
  "10": "éŸ³æ¥½",                   // Music - æ­Œé…ä¿¡ãƒ»éŸ³æ¥½é–¢é€£
  "15": "ãƒšãƒƒãƒˆãƒ»å‹•ç‰©",             // Pets & Animals
  "17": "ã‚¹ãƒãƒ¼ãƒ„",                // Sports
  "18": "çŸ­ç·¨æ˜ ç”»",                // Short Movies
  "19": "æ—…è¡Œãƒ»ã‚¤ãƒ™ãƒ³ãƒˆ",            // Travel & Events
  "20": "ã‚²ãƒ¼ãƒ ",                  // Gaming - ã‚²ãƒ¼ãƒ é…ä¿¡
  "21": "ãƒ–ãƒ­ã‚°",                  // Videoblogging
  "22": "ä¸€èˆ¬ãƒ»ãƒ–ãƒ­ã‚°",             // People & Blogs - é›‘è«‡é…ä¿¡
  "23": "ã‚³ãƒ¡ãƒ‡ã‚£",                // Comedy
  "24": "ã‚¨ãƒ³ã‚¿ãƒ¼ãƒ†ã‚¤ãƒ¡ãƒ³ãƒˆ",        // Entertainment
  "25": "ãƒ‹ãƒ¥ãƒ¼ã‚¹ãƒ»æ”¿æ²»",           // News & Politics
  "26": "ãƒã‚¦ãƒ„ãƒ¼ãƒ»ã‚¹ã‚¿ã‚¤ãƒ«",        // Howto & Style
  "27": "æ•™è‚²",                   // Education
  "28": "ç§‘å­¦ãƒ»æŠ€è¡“",              // Science & Technology
  "29": "éå–¶åˆ©ãƒ»ç¤¾ä¼šæ´»å‹•",         // Nonprofits & Activism
  "30": "æ˜ ç”»",                   // Movies
  "31": "ã‚¢ãƒ‹ãƒ¡ãƒ»ãƒãƒ³ã‚¬",           // Anime/Manga
  "32": "ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãƒ»ã‚¢ãƒ‰ãƒ™ãƒ³ãƒãƒ£ãƒ¼", // Action/Adventure
  "33": "ã‚¯ãƒ©ã‚·ãƒƒã‚¯",              // Classics
  "34": "ã‚³ãƒ¡ãƒ‡ã‚£æ˜ ç”»",            // Comedy
  "35": "ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ã‚¿ãƒªãƒ¼",         // Documentary
  "36": "ãƒ‰ãƒ©ãƒ",                 // Drama
  "37": "å®¶æ—å‘ã‘",               // Family
  "38": "æµ·å¤–æ˜ ç”»",               // Foreign
  "39": "ãƒ›ãƒ©ãƒ¼",                 // Horror
  "40": "SFãƒ»ãƒ•ã‚¡ãƒ³ã‚¿ã‚¸ãƒ¼",         // Sci-Fi/Fantasy
  "41": "ã‚¹ãƒªãƒ©ãƒ¼",               // Thriller
  "42": "çŸ­ç·¨",                   // Shorts
  "43": "ç•ªçµ„",                   // Shows
  "44": "äºˆå‘Šç·¨",                 // Trailers
} as const;

function getCategoryName(categoryId: string): string {
  return YOUTUBE_CATEGORIES[categoryId] || 'æœªåˆ†é¡';
}
```

### YouTubeãƒˆãƒ”ãƒƒã‚¯ã‚«ãƒ†ã‚´ãƒªæ´»ç”¨

```typescript
// æ—¢å­˜ãƒ‡ãƒ¼ã‚¿ã®æ´»ç”¨ï¼ˆå®Ÿè£…æ¸ˆã¿ï¼‰
interface TopicDetails {
  topicCategories?: string[];        // Wikipedia URLã®é…åˆ—
}

// URLã‹ã‚‰ã‚«ãƒ†ã‚´ãƒªåã‚’æŠ½å‡º
function extractCategoryName(url: string): string {
  return url.split('/').pop()?.replace(/_/g, ' ') || '';
}

// ä¾‹: "https://en.wikipedia.org/wiki/Music" â†’ "Music"
```

### æ¤œç´¢ã‚¯ã‚¨ãƒªå®Ÿè£…

```typescript
// 1. ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆã‚¿ã‚°ã®æ¤œç´¢
.where("playlistTags", "array-contains", playlistTag)
.where("videoType", "==", "all")
.orderBy("publishedAt", "desc")

// 2. YouTubeã‚«ãƒ†ã‚´ãƒªIDã®æ¤œç´¢
.where("categoryId", "==", categoryId)
.where("videoType", "==", "all")
.orderBy("publishedAt", "desc")

// 3. ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¿ã‚°ã®æ¤œç´¢
.where("userTags", "array-contains", userTag)
.where("videoType", "==", "all")
.orderBy("publishedAt", "desc")

// è¤‡åˆæ¤œç´¢ï¼ˆã‚«ãƒ†ã‚´ãƒªâ†’ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¿ã‚°ã®çµ„ã¿åˆã‚ã›ï¼‰
.where("categoryId", "==", categoryId)
.where("userTags", "array-contains", userTag)
.where("videoType", "==", "all")
.orderBy("publishedAt", "desc")

// è¤‡åˆæ¤œç´¢ï¼ˆãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆâ†’ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¿ã‚°ã®çµ„ã¿åˆã‚ã›ï¼‰
.where("playlistTags", "array-contains", playlistTag)
.where("userTags", "array-contains", userTag)
.where("videoType", "==", "all")
.orderBy("publishedAt", "desc")
```

## ã‚¿ã‚°è¨­è¨ˆæ–¹é‡

### 3å±¤ã‚¿ã‚°ã‚·ã‚¹ãƒ†ãƒ 

#### 1. è‡ªå‹•ã‚¿ã‚°ï¼ˆãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆãƒ™ãƒ¼ã‚¹ï¼‰- æœ€å„ªå…ˆè¡¨ç¤º
- **è‡ªå‹•ç”Ÿæˆ**: YouTubeãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆåã‹ã‚‰è‡ªå‹•ä»˜ä¸
- **ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ€§**: æŠ•ç¨¿è€…ãŒå‹•ç”»ã‚’ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆã«è¿½åŠ /å‰Šé™¤ã™ã‚‹ã¨è‡ªå‹•æ›´æ–°
- **å…·ä½“çš„åˆ†é¡**: ã€Œæ­Œã£ã¦ã¿ãŸã€ã€Œé›‘è«‡é…ä¿¡ã€ã€Œã‚²ãƒ¼ãƒ å®Ÿæ³ã€ã€ŒASMRã€ç­‰
- **APIå–å¾—**: æ—¥æ¬¡ãƒãƒƒãƒã§ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆæƒ…å ±ã‚’å–å¾—
- **ã‚³ã‚¹ãƒˆ**: 1æ—¥60-120ã‚¯ã‚©ãƒ¼ã‚¿ï¼ˆç¾åœ¨ã®1-2%å¢—ï¼‰

#### 2. è‡ªå‹•ã‚¿ã‚°ï¼ˆã‚«ãƒ†ã‚´ãƒªIDï¼‰- ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ç”¨
- **æŠ•ç¨¿è€…é¸æŠ**: YouTubeæŠ•ç¨¿è€…ãŒæ‰‹å‹•ã§é¸æŠã—ãŸã‚«ãƒ†ã‚´ãƒª
- **44ç¨®é¡ã®å›ºå®šã‚«ãƒ†ã‚´ãƒª**: éŸ³æ¥½ã€ã‚²ãƒ¼ãƒ ã€ã‚¨ãƒ³ã‚¿ãƒ¼ãƒ†ã‚¤ãƒ¡ãƒ³ãƒˆç­‰
- **æ—¥æœ¬èªåŒ–å¯¾å¿œ**: ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ã¨ã£ã¦ç†è§£ã—ã‚„ã™ã„æ—¥æœ¬èªè¡¨ç¤º
- **æ—¢å­˜ãƒ‡ãƒ¼ã‚¿æ´»ç”¨**: å®Œå…¨å®Ÿè£…æ¸ˆã¿ã€è¿½åŠ ã‚³ã‚¹ãƒˆãªã—

#### 3. æ‰‹å‹•ã‚¿ã‚°ï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼ç·¨é›†å¯èƒ½ï¼‰- è©³ç´°åˆ†é¡
- **ç™»éŒ²ãƒ¦ãƒ¼ã‚¶ãƒ¼ç·¨é›†**: èªè¨¼æ¸ˆã¿ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒè‡ªç”±ã«ç·¨é›†å¯èƒ½
- **ãƒã‚¹ã‚¿ãƒ¼ãƒ‡ãƒ¼ã‚¿ãªã—**: ã‚¿ã‚°ã¯å®Œå…¨ã«è‡ªç”±å…¥åŠ›ã€çµ±åˆ¶ãªã—
- **ãƒ•ãƒ©ãƒƒãƒˆæ§‹é€ **: éšå±¤åŒ–ã‚„ã‚«ãƒ†ã‚´ãƒªåˆ†ã‘ãªã—
- **ASMRç‰¹åŒ–**: è€³ã‹ãã€å›ãã€ãƒã‚¤ãƒãƒ¼ãƒ©ãƒ«ç­‰ã®å°‚é–€ç”¨èª
- **ã‚·ãƒ³ãƒ—ãƒ«ç·¨é›†**: ç›´æ¥ç·¨é›†ã€å±¥æ­´è¨˜éŒ²ãªã—
- **æ—¢å­˜å®Ÿè£…ã¨çµ±ä¸€**: éŸ³å£°ãƒœã‚¿ãƒ³ã¨åŒã˜UI/UXãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’æµç”¨

### æƒ³å®šã‚¿ã‚°ä¾‹

#### 1. ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆã‚¿ã‚°ï¼ˆè‡ªå‹•ãƒ»æœ€å„ªå…ˆï¼‰
- **å®Ÿéš›ã®æ¶¼èŠ±ã¿ãªã›ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆä¾‹**:
  - ã€Œæ­Œã£ã¦ã¿ãŸã€
  - ã€Œé›‘è«‡é…ä¿¡ã€
  - ã€Œã‚²ãƒ¼ãƒ å®Ÿæ³ã€
  - ã€ŒASMRã€
  - ã€Œæœ—èª­ãƒ»éŸ³å£°ä½œå“ã€
  - ã€Œæ­Œæ ã€
  - ã€Œã‚³ãƒ©ãƒœã€
  - ã€Œè¨˜å¿µé…ä¿¡ã€

#### 2. ã‚«ãƒ†ã‚´ãƒªIDã‚¿ã‚°ï¼ˆè‡ªå‹•ãƒ»ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ç”¨ï¼‰
- **10 - éŸ³æ¥½**: æ­Œé…ä¿¡ã€éŸ³æ¥½é–¢é€£
- **20 - ã‚²ãƒ¼ãƒ **: ã‚²ãƒ¼ãƒ é…ä¿¡ã€ã‚²ãƒ¼ãƒ å®Ÿæ³
- **22 - ä¸€èˆ¬ãƒ»ãƒ–ãƒ­ã‚°**: é›‘è«‡é…ä¿¡ã€å€‹äººãƒ–ãƒ­ã‚°
- **24 - ã‚¨ãƒ³ã‚¿ãƒ¼ãƒ†ã‚¤ãƒ¡ãƒ³ãƒˆ**: ã‚¨ãƒ³ã‚¿ãƒ¼ãƒ†ã‚¤ãƒ¡ãƒ³ãƒˆå…¨èˆ¬
- **23 - ã‚³ãƒ¡ãƒ‡ã‚£**: ã‚³ãƒ¡ãƒ‡ã‚£ã€ãŠã‚‚ã—ã‚ã‚³ãƒ³ãƒ†ãƒ³ãƒ„
- **26 - ãƒã‚¦ãƒ„ãƒ¼ãƒ»ã‚¹ã‚¿ã‚¤ãƒ«**: ãƒã‚¦ãƒ„ãƒ¼ã€ã‚¹ã‚¿ã‚¤ãƒ«
- **1 - æ˜ ç”»ãƒ»ã‚¢ãƒ‹ãƒ¡**: æ˜ ç”»ã€ã‚¢ãƒ‹ãƒ¡é–¢é€£
- **27 - æ•™è‚²**: æ•™è‚²ãƒ»å­¦ç¿’ã‚³ãƒ³ãƒ†ãƒ³ãƒ„

#### 3. ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¿ã‚°ï¼ˆæ‰‹å‹•ãƒ»è©³ç´°ï¼‰
- **ã‚¸ãƒ£ãƒ³ãƒ«**: éŸ³å£°ä½œå“ã€ãƒ‰ãƒ©ãƒCDã€ãƒ•ãƒªãƒ¼ãƒˆãƒ¼ã‚¯ã€æ­Œã€é…ä¿¡ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–
- **ã‚·ãƒãƒ¥ã‚¨ãƒ¼ã‚·ãƒ§ãƒ³**: è€³ã‹ãã€ãƒãƒƒã‚µãƒ¼ã‚¸ã€æ·»ã„å¯ã€ãŠé¢¨å‘‚ã€æ–™ç†
- **æ„Ÿæƒ…ãƒ»é›°å›²æ°—**: ç™’ã—ã€ç”˜ã€…ã€ãŠã­ã ã‚Šã€ãŠå§‰ã•ã‚“ã€å¦¹ç³»
- **æŠ€è¡“çš„ç‰¹å¾´**: ãƒã‚¤ãƒãƒ¼ãƒ©ãƒ«ã€ç«‹ä½“éŸ³éŸ¿ã€å›ãã€æ–¹è¨€ã€ã‚³ã‚¹ãƒ—ãƒ¬
- **æ™‚é–“å¸¯**: æœã€æ˜¼ã€å¤œã€æ·±å¤œ
- **å­£ç¯€ãƒ»ã‚¤ãƒ™ãƒ³ãƒˆ**: æ˜¥ã€å¤ã€ç§‹ã€å†¬ã€ã‚¯ãƒªã‚¹ãƒã‚¹ã€ãƒãƒ¬ãƒ³ã‚¿ã‚¤ãƒ³

## UI/UXè¨­è¨ˆ

### 3å±¤è¡¨ç¤ºãƒ‘ã‚¿ãƒ¼ãƒ³

#### å‹•ç”»è©³ç´°ç”»é¢ã§ã®è¡¨ç¤ºä¾‹

```tsx
{/* 1. ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆã‚¿ã‚°ï¼ˆæœ€å„ªå…ˆãƒ»è‡ªå‹•ï¼‰ */}
{video.playlistTags && video.playlistTags.length > 0 && (
  <div className="mb-4">
    <h4 className="text-sm font-medium mb-2 flex items-center">
      <PlayIcon className="w-4 h-4 mr-2" />
      ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆ
    </h4>
    <TagList 
      tags={video.playlistTags} 
      variant="default" 
      showIcon={false} 
      size="default"
      className="bg-blue-50 border-blue-200"
    />
  </div>
)}

{/* 2. ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¿ã‚°ï¼ˆãƒ¡ã‚¤ãƒ³ãƒ»ç·¨é›†å¯èƒ½ï¼‰ */}
<div className="mb-4">
  <div className="flex items-center justify-between mb-2">
    <h4 className="text-sm font-medium flex items-center">
      <TagIcon className="w-4 h-4 mr-2" />
      ã‚¿ã‚°
    </h4>
    {isAuthenticated && (
      <EditButton onClick={() => setEditMode(true)} size="sm">
        ç·¨é›†
      </EditButton>
    )}
  </div>
  {editMode ? (
    <UserTagEditor 
      initialTags={video.userTags}
      onSave={handleTagSave}
      onCancel={() => setEditMode(false)}
    />
  ) : (
    <TagList 
      tags={video.userTags} 
      variant="outline" 
      showIcon={true} 
      size="default"
    />
  )}
</div>

{/* 3. YouTubeã‚«ãƒ†ã‚´ãƒªï¼ˆãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ç”¨ãƒ»è‡ªå‹•ï¼‰ */}
{video.categoryId && (
  <div className="mb-4">
    <h4 className="text-sm font-medium mb-2">ã‚«ãƒ†ã‚´ãƒª</h4>
    <TagList 
      tags={[getCategoryName(video.categoryId)]} 
      variant="secondary" 
      showIcon={false}
      size="sm"
    />
  </div>
)}
```

#### è¦–è¦šçš„åŒºåˆ¥ã¨å„ªå…ˆåº¦

| ã‚¿ã‚¤ãƒ— | ãƒãƒªã‚¢ãƒ³ãƒˆ | ã‚¢ã‚¤ã‚³ãƒ³ | ã‚µã‚¤ã‚º | å„ªå…ˆåº¦ | ç·¨é›† | ç”¨é€” |
|------|---------|---------|------|---------|------|------|
| ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆ | default + é’èƒŒæ™¯ | PlayIcon | default | 1ä½ | Ã— | æœ€å„ªå…ˆåˆ†é¡ |
| ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¿ã‚° | outline | TagIcon | default | 2ä½ | âœ“ | ãƒ¡ã‚¤ãƒ³åˆ†é¡ |
| ã‚«ãƒ†ã‚´ãƒªID | secondary | Ã— | sm | 3ä½ | Ã— | ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ |

#### è¡¨ç¤ºç®‡æ‰€åˆ¥å¯¾å¿œ

1. **å‹•ç”»ä¸€è¦§ç”»é¢**: ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆã‚¿ã‚°+ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¿ã‚°ã®ã¿è¡¨ç¤ºï¼ˆã‚¹ãƒšãƒ¼ã‚¹ç¯€ç´„ï¼‰
2. **å‹•ç”»è©³ç´°ç”»é¢**: 3å±¤ã™ã¹ã¦è¡¨ç¤º
3. **æ¤œç´¢ãƒ»ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼**: 3ã¤ã®ç‹¬ç«‹ã—ãŸãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã¨ã—ã¦æä¾›

#### ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¿ã‚°ç·¨é›†æ©Ÿèƒ½

```tsx
interface UserTagEditorProps {
  initialTags: string[];
  onSave: (tags: string[]) => Promise<void>;
  onCancel: () => void;
}

function UserTagEditor({ initialTags, onSave, onCancel }: UserTagEditorProps) {
  const [tags, setTags] = useState<string[]>(initialTags);
  const [isSaving, setIsSaving] = useState(false);

  return (
    <div className="space-y-3 p-4 border rounded-lg bg-gray-50">
      <TagInput 
        tags={tags}
        onChange={setTags}
        maxTags={15}
        maxLength={30}
        placeholder="ã‚¿ã‚°ã‚’å…¥åŠ›ã—ã¦Enterã‚­ãƒ¼ã§è¿½åŠ "
      />
      <div className="flex gap-2">
        <Button 
          onClick={() => onSave(tags)}
          disabled={isSaving}
          size="sm"
        >
          {isSaving ? 'ä¿å­˜ä¸­...' : 'ä¿å­˜'}
        </Button>
        <Button 
          onClick={onCancel}
          variant="outline"
          size="sm"
        >
          ã‚­ãƒ£ãƒ³ã‚»ãƒ«
        </Button>
      </div>
    </div>
  );
}
```

### ç®¡ç†æ©Ÿèƒ½

#### ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆã‚¿ã‚°ç®¡ç†ï¼ˆè‡ªå‹•ï¼‰
1. **è‡ªå‹•å–å¾—**: æ—¥æ¬¡ãƒãƒƒãƒã§YouTubeãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆæƒ…å ±ã‚’å–å¾—
2. **è‡ªå‹•æ›´æ–°**: ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆå¤‰æ›´ã®è‡ªå‹•åæ˜ 
3. **è¡¨ç¤ºåˆ¶å¾¡**: ç‰¹å®šãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆã®è¡¨ç¤º/éè¡¨ç¤ºè¨­å®š
4. **ç®¡ç†ç”»é¢**: ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆã‚¿ã‚°ã®ä¸€è¦§ãƒ»çµ±è¨ˆè¡¨ç¤º

#### ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¿ã‚°ç®¡ç†ï¼ˆæ‰‹å‹•ãƒ»ç·¨é›†å¯èƒ½ï¼‰
1. **ç·¨é›†æ¨©é™**: èªè¨¼æ¸ˆã¿ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ã¿ç·¨é›†å¯èƒ½
2. **ã‚·ãƒ³ãƒ—ãƒ«ç·¨é›†**: ç›´æ¥ç·¨é›†ã€å±¥æ­´è¨˜éŒ²ãªã—
3. **ä¿¡é ¼ãƒ™ãƒ¼ã‚¹**: èªè¨¼ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’ä¿¡ç”¨ã€ãƒ¢ãƒ‡ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãªã—
4. **ä¸€æ‹¬ç·¨é›†**: ç®¡ç†è€…ã«ã‚ˆã‚‹è¤‡æ•°å‹•ç”»ã¸ã®ä¸€æ‹¬ã‚¿ã‚°é©ç”¨

#### çµ±è¨ˆãƒ»åˆ†ææ©Ÿèƒ½
1. **3å±¤ã‚¿ã‚°çµ±è¨ˆ**: å„å±¤åˆ¥ã®ä½¿ç”¨é »åº¦ãƒ»å‹•ç”»æ•°
2. **ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆåˆ†æ**: ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆåˆ¥å‹•ç”»åˆ†å¸ƒ
3. **ã‚¯ãƒ­ã‚¹åˆ†æ**: ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆÃ—ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¿ã‚°ã®ç›¸é–¢
4. **ãƒˆãƒ¬ãƒ³ãƒ‰åˆ†æ**: ã‚¿ã‚°ä½¿ç”¨é »åº¦ã®æ™‚ç³»åˆ—å¤‰åŒ–

#### æ¨©é™ãƒ»ä¿¡é ¼ã‚·ã‚¹ãƒ†ãƒ 
1. **ç·¨é›†æ¨©é™**: èªè¨¼ãƒ¦ãƒ¼ã‚¶ãƒ¼ > ç®¡ç†è€…
2. **ä¿¡é ¼ãƒ™ãƒ¼ã‚¹**: èªè¨¼ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’ä¿¡ç”¨ã€æ¤œè¨¼ãªã—
3. **åˆ¶é™ãªã—**: ãƒ¬ãƒ¼ãƒˆåˆ¶é™ã‚‚è¨­ã‘ãªã„

## å®Ÿè£…æ®µéš

### Phase 1: åŸºç›¤æ§‹ç¯‰ï¼ˆfetchYoutubeVideosçµ±åˆï¼‰âœ… å®Œäº†

- [x] **æ—¢å­˜YouTubeAPIçµ±åˆæ‹¡å¼µ**
  - [x] `youtube-quota-monitor.ts`: ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆé–¢é€£ã‚¯ã‚©ãƒ¼ã‚¿å®šç¾©è¿½åŠ 
  - [x] `youtube-api.ts`: `fetchChannelPlaylists`é–¢æ•°è¿½åŠ 
  - [x] `youtube-api.ts`: `fetchPlaylistItems`é–¢æ•°è¿½åŠ 
- [x] **Cloud Functionsçµ±åˆ**
  - [x] `fetchYouTubeVideos`é–¢æ•°ã«ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆå–å¾—å‡¦ç†ã‚’çµ±åˆ
  - [x] ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆâ†’å‹•ç”»ãƒãƒƒãƒ”ãƒ³ã‚°ç”Ÿæˆå‡¦ç†è¿½åŠ 
  - [x] å‹•ç”»ãƒ‡ãƒ¼ã‚¿ä¿å­˜æ™‚ã«`playlistTags`ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰è¿½åŠ 
- [x] **ãƒ‡ãƒ¼ã‚¿ã‚¹ã‚­ãƒ¼ãƒæ‹¡å¼µ**
  - [x] `shared-types/src/video.ts`: `playlistTags`ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰è¿½åŠ 
  - [x] `shared-types/src/video.ts`: `userTags`ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰è¿½åŠ 
  - [x] Zodãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚¹ã‚­ãƒ¼ãƒæ›´æ–°
- [x] **Firestoreã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹è¨­å®š**
  - [x] `playlistTags`é…åˆ—ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹è¨­å®š
  - [x] `userTags`é…åˆ—ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹è¨­å®š
  - [x] è¤‡åˆã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹è¨­å®šï¼ˆæ¤œç´¢ç”¨ï¼‰

### Phase 2: ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¿ã‚°ç·¨é›†æ©Ÿèƒ½âœ… å®Œäº†

- [x] ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¿ã‚°ç·¨é›†ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆä½œæˆ
  - [x] TagInputï¼ˆå…¥åŠ›ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ï¼‰
  - [x] UserTagEditorï¼ˆç·¨é›†ãƒ¢ãƒ¼ãƒ€ãƒ«ï¼‰
  - [x] EditButtonï¼ˆç·¨é›†ãƒœã‚¿ãƒ³ï¼‰
- [x] æ¨©é™ãƒã‚§ãƒƒã‚¯æ©Ÿèƒ½ï¼ˆèªè¨¼ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ã¿ï¼‰
- [x] Server Actionså®Ÿè£…ï¼ˆã‚·ãƒ³ãƒ—ãƒ«ã‚¿ã‚°æ›´æ–°ï¼‰

### Phase 3: UIå®Ÿè£…ï¼ˆ3å±¤è¡¨ç¤ºï¼‰âœ… å®Œäº†

- [x] TagListã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆæ‹¡å¼µï¼ˆ3å±¤å¯¾å¿œï¼‰
- [x] å‹•ç”»è©³ç´°ç”»é¢ã§ã®3å±¤è¡¨ç¤ºå®Ÿè£…
- [x] å‹•ç”»ä¸€è¦§ç”»é¢ã§ã®3å±¤è¡¨ç¤ºå®Ÿè£…
- [x] ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆã‚¿ã‚°å°‚ç”¨ã‚¹ã‚¿ã‚¤ãƒ«ï¼ˆé’èƒŒæ™¯ï¼‰
- [x] ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¿ã‚°ç·¨é›†ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹
- [x] ã‚¢ã‚¤ã‚³ãƒ³è¿½åŠ ï¼ˆPlayIconã€TagIconï¼‰
- [x] ThreeLayerTagDisplayã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆä½œæˆ
- [x] YouTubeã‚«ãƒ†ã‚´ãƒªåæ—¥æœ¬èªåŒ–ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£

### Phase 4: æ¤œç´¢ãƒ»ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼

- [ ] 3å±¤æ¤œç´¢ã‚·ã‚¹ãƒ†ãƒ å®Ÿè£…
  - [ ] ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆã‚¿ã‚°æ¤œç´¢
  - [ ] ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¿ã‚°æ¤œç´¢
  - [ ] ã‚«ãƒ†ã‚´ãƒªIDæ¤œç´¢
- [ ] è¤‡åˆãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°å®Ÿè£…
- [ ] 3å±¤ã‚¿ã‚°ãƒã‚¤ãƒ©ã‚¤ãƒˆè¡¨ç¤ºæ©Ÿèƒ½

### Phase 5: ç®¡ç†æ©Ÿèƒ½

- [ ] ç®¡ç†ç”»é¢ã§ã®3å±¤ã‚¿ã‚°çµ±è¨ˆè¡¨ç¤º
- [ ] ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆã‚¿ã‚°ç®¡ç†ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹

### Phase 6: å°†æ¥ã®æ‹¡å¼µæ©Ÿèƒ½ï¼ˆä»Šå›ã¯å®Ÿè£…ã—ãªã„ï¼‰

- [ ] ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆãƒ»ã‚«ãƒ†ã‚´ãƒªãƒ™ãƒ¼ã‚¹ã®ã‚¿ã‚°æ¨è–¦
- [ ] 3å±¤é–¢é€£ã‚¿ã‚°è¡¨ç¤º
- [ ] 3å±¤ã‚¿ã‚°ãƒ™ãƒ¼ã‚¹æ¨è–¦ã‚·ã‚¹ãƒ†ãƒ 
- [ ] ã‚¿ã‚°ãƒˆãƒ¬ãƒ³ãƒ‰åˆ†ææ©Ÿèƒ½

## ãƒ‡ãƒ¼ã‚¿ç§»è¡Œè¨ˆç”»

### æ—¢å­˜ãƒ‡ãƒ¼ã‚¿ã¸ã®3å±¤ã‚¿ã‚°é©ç”¨æ–¹æ³•

#### 1. ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆã‚¿ã‚°ï¼ˆè‡ªå‹•ï¼‰
- **å®Œå…¨è‡ªå‹•**: YouTubeãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆæƒ…å ±ã‚’å³åº§ã«å–å¾—ãƒ»é©ç”¨
- **ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ åæ˜ **: æ–°ã—ã„ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆè¿½åŠ æ™‚ã®è‡ªå‹•æ›´æ–°
- **å±¥æ­´ãƒ‡ãƒ¼ã‚¿**: éå»ã®å‹•ç”»ã«ã‚‚é¡ã£ã¦ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆæƒ…å ±ã‚’é©ç”¨

#### 2. ã‚«ãƒ†ã‚´ãƒªIDã‚¿ã‚°ï¼ˆæ—¢å­˜ãƒ‡ãƒ¼ã‚¿æ´»ç”¨ï¼‰
- **å³åº§ã«åˆ©ç”¨å¯èƒ½**: æ—¢å­˜ã®`categoryId`ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’æ´»ç”¨
- **è¿½åŠ ã‚³ã‚¹ãƒˆãªã—**: æ–°ãŸãªAPIå–å¾—ã‚„ãƒ‡ãƒ¼ã‚¿ç§»è¡Œä¸è¦

#### 3. ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¿ã‚°ï¼ˆæ‰‹å‹•ãƒ»æ®µéšçš„ï¼‰
- **åˆæœŸã‚¿ã‚°ãªã—**: æ–°è¦ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®ãŸã‚åˆæœŸå€¤ã¯ç©ºé…åˆ—
- **ãƒ¦ãƒ¼ã‚¶ãƒ¼ä¸»å°**: èªè¨¼ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ã‚ˆã‚‹æ®µéšçš„ãªã‚¿ã‚°ä»˜ã‘
- **ç®¡ç†è€…æ”¯æ´**: åˆæœŸæ®µéšã§ã®ç®¡ç†è€…ã«ã‚ˆã‚‹åŸºæœ¬ã‚¿ã‚°è¨­å®š

#### 4. ç§»è¡Œã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ï¼ˆfetchYoutubeVideosçµ±åˆç‰ˆï¼‰
1. **Week 1**: 
   - YouTubeAPIçµ±åˆæ‹¡å¼µï¼ˆ`youtube-api.ts`, `youtube-quota-monitor.ts`ï¼‰
   - ãƒ‡ãƒ¼ã‚¿ã‚¹ã‚­ãƒ¼ãƒæ‹¡å¼µï¼ˆ`shared-types`ï¼‰
   - Cloud Functionsçµ±åˆï¼ˆ`fetchYouTubeVideos`ä¿®æ­£ï¼‰
2. **Week 2**: 
   - Firestoreã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹è¨­å®š
   - ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆã‚¿ã‚°è‡ªå‹•ç”Ÿæˆãƒ†ã‚¹ãƒˆ
   - ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¿ã‚°ç·¨é›†æ©Ÿèƒ½å®Ÿè£…
3. **Week 3**: UIå®Ÿè£…ãƒ»3å±¤è¡¨ç¤º
4. **Week 4**: æ¤œç´¢ãƒ»ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼çµ±åˆ

**çµ±åˆãƒ¡ãƒªãƒƒãƒˆ**: æ—¢å­˜ã®å …ç‰¢ãªYouTube APIåŸºç›¤ã‚’æ´»ç”¨ã—ã€é–‹ç™ºæœŸé–“ã‚’çŸ­ç¸®

## ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹è€ƒæ…®äº‹é …

### ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹è¨­è¨ˆï¼ˆ3å±¤å¯¾å¿œï¼‰

```javascript
// 1. ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆã‚¿ã‚°ç”¨ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹
db.collection('videos').index(['playlistTags', 'publishedAt']);
db.collection('videos').index(['playlistTags', 'statistics.viewCount']);
db.collection('videos').index(['playlistTags', 'videoType']);

// 2. ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¿ã‚°ç”¨ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹
db.collection('videos').index(['userTags', 'publishedAt']);
db.collection('videos').index(['userTags', 'statistics.viewCount']);
db.collection('videos').index(['userTags', 'videoType']);

// 3. YouTubeã‚«ãƒ†ã‚´ãƒªIDç”¨ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ï¼ˆæ—¢å­˜ï¼‰
db.collection('videos').index(['categoryId', 'publishedAt']);
db.collection('videos').index(['categoryId', 'statistics.viewCount']);
db.collection('videos').index(['categoryId', 'videoType']);

// è¤‡åˆã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ï¼ˆã‚«ãƒ†ã‚´ãƒª Ã— ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¿ã‚°ï¼‰
db.collection('videos').index(['categoryId', 'userTags', 'publishedAt']);
db.collection('videos').index(['playlistTags', 'userTags', 'publishedAt']);
```

### ã‚­ãƒ£ãƒƒã‚·ãƒ¥æˆ¦ç•¥ï¼ˆ3å±¤å¯¾å¿œï¼‰

- **ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆã‚¿ã‚°ã‚­ãƒ£ãƒƒã‚·ãƒ¥**: äººæ°—ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆãƒ»å‹•ç”»æ•°ã®1æ™‚é–“ã‚­ãƒ£ãƒƒã‚·ãƒ¥
- **ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¿ã‚°ã‚­ãƒ£ãƒƒã‚·ãƒ¥**: äººæ°—ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¿ã‚°ãƒ»ä½¿ç”¨é »åº¦ã®30åˆ†ã‚­ãƒ£ãƒƒã‚·ãƒ¥
- **3å±¤æ¤œç´¢çµæœã‚­ãƒ£ãƒƒã‚·ãƒ¥**: æ¤œç´¢çµæœã®15åˆ†ã‚­ãƒ£ãƒƒã‚·ãƒ¥
- **ã‚¿ã‚°çµ±è¨ˆã‚­ãƒ£ãƒƒã‚·ãƒ¥**: å„å±¤åˆ¥çµ±è¨ˆãƒ‡ãƒ¼ã‚¿ã®6æ™‚é–“ã‚­ãƒ£ãƒƒã‚·ãƒ¥

### APIã‚¯ã‚©ãƒ¼ã‚¿ç®¡ç†

#### fetchYoutubeVideosçµ±åˆã§ã®ã‚¯ã‚©ãƒ¼ã‚¿æœ€é©åŒ–
- **æ—¢å­˜å‡¦ç†ã‚³ã‚¹ãƒˆ**: å‹•ç”»æ¤œç´¢100 + å‹•ç”»è©³ç´°å–å¾—8Ã—N = ç´„500-800ã‚¯ã‚©ãƒ¼ã‚¿/æ—¥
- **ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆè¿½åŠ ã‚³ã‚¹ãƒˆ**: 
  - ãƒãƒ£ãƒ³ãƒãƒ«ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆå–å¾—: 1ã‚¯ã‚©ãƒ¼ã‚¿
  - ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆã‚¢ã‚¤ãƒ†ãƒ å–å¾—: 1Ã—Nï¼ˆãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆæ•°ï¼‰
  - **æ¨å®šè¿½åŠ **: 10-20ã‚¯ã‚©ãƒ¼ã‚¿/æ—¥ï¼ˆå…¨ä½“ã®2-4%å¢—ï¼‰
- **çµ±åˆãƒ¡ãƒªãƒƒãƒˆ**: 
  - åŒä¸€Cloud Functionå®Ÿè¡Œå†…ã§å‡¦ç†
  - æ—¢å­˜ã®ã‚¯ã‚©ãƒ¼ã‚¿ç›£è¦–ã‚·ã‚¹ãƒ†ãƒ æ´»ç”¨
  - ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ãƒ»ãƒªãƒˆãƒ©ã‚¤æ©Ÿèƒ½å…±æœ‰
- **åŠ¹ç‡åŒ–æˆ¦ç•¥**: 
  - ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆæƒ…å ±ã®ã‚­ãƒ£ãƒƒã‚·ãƒ¥æ´»ç”¨
  - å¤‰æ›´æ¤œçŸ¥ã«ã‚ˆã‚‹å·®åˆ†æ›´æ–°
  - æ—¢å­˜ã®æ—¥æ¬¡å®Ÿè¡Œã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã«çµ±åˆ

## ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ»æ¨©é™

### 3å±¤ã‚¿ã‚°æ¨©é™ä½“ç³»

#### ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆã‚¿ã‚°ï¼ˆè‡ªå‹•ç”Ÿæˆï¼‰
- **ã‚·ã‚¹ãƒ†ãƒ ç®¡ç†**: å®Œå…¨è‡ªå‹•ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ç·¨é›†ä¸å¯
- **è¡¨ç¤ºåˆ¶å¾¡**: ç®¡ç†è€…ã«ã‚ˆã‚‹è¡¨ç¤º/éè¡¨ç¤ºè¨­å®šã®ã¿

#### ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¿ã‚°ï¼ˆç·¨é›†å¯èƒ½ï¼‰
- **èªè¨¼ãƒ¦ãƒ¼ã‚¶ãƒ¼**: ã™ã¹ã¦ã®å‹•ç”»ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¿ã‚°ç·¨é›†å¯èƒ½
- **ç®¡ç†è€…**: ä¸€æ‹¬ç·¨é›†ãƒ»ã‚·ã‚¹ãƒ†ãƒ è¨­å®š

#### ã‚«ãƒ†ã‚´ãƒªIDï¼ˆè‡ªå‹•å–å¾—ï¼‰
- **ã‚·ã‚¹ãƒ†ãƒ ç®¡ç†**: YouTube APIã‹ã‚‰è‡ªå‹•å–å¾—ã€ç·¨é›†ä¸å¯
- **è¡¨ç¤ºåˆ¶å¾¡**: ç®¡ç†è€…ã«ã‚ˆã‚‹è¡¨ç¤ºè¨­å®šã®ã¿

### ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆ3å±¤å¯¾å¿œï¼‰

#### ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆã‚¿ã‚°
- **è‡ªå‹•ç”Ÿæˆ**: YouTubeãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆåã‚’ãã®ã¾ã¾ä½¿ç”¨
- **æ–‡å­—æ•°åˆ¶é™**: æœ€å¤§50æ–‡å­—ï¼ˆãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆåã®é•·ã•ã«å¯¾å¿œï¼‰
- **é…åˆ—ä¸Šé™**: æœ€å¤§20å€‹ï¼ˆæƒ³å®šãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆæ•°ï¼‰

#### ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¿ã‚°ï¼ˆéŸ³å£°ãƒœã‚¿ãƒ³ã¨åŒã˜åˆ¶ç´„ï¼‰
- **ã‚¿ã‚°åã®é•·ã•åˆ¶é™**: 1-30æ–‡å­—
- **ã‚¿ã‚°æ•°ã®ä¸Šé™**: æœ€å¤§15å€‹
- **é‡è¤‡ã‚¿ã‚°ã®ãƒã‚§ãƒƒã‚¯**: åŒä¸€ã‚¿ã‚°ã®é‡è¤‡ç¦æ­¢
- **ç©ºæ–‡å­—ã‚¿ã‚°ã®ç¦æ­¢**: å¿…é ˆãƒã‚§ãƒƒã‚¯

---

---

**ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆå±¥æ­´**:

- 2025-07-17: åˆæœŸè¨­è¨ˆæ–‡æ›¸ä½œæˆ
- 2025-07-17: éŸ³å£°ãƒœã‚¿ãƒ³ã®ã‚¿ã‚°å®Ÿè£…ã‚’å‚è€ƒã«ãƒã‚¹ã‚¿ãƒ¼ãƒ‡ãƒ¼ã‚¿ãƒ¬ã‚¹è¨­è¨ˆã«å¤‰æ›´
- 2025-07-17: YouTubeãƒˆãƒ”ãƒƒã‚¯ã‚«ãƒ†ã‚´ãƒªã‚’è£œåŠ©çš„ã‚¿ã‚°ã¨ã—ã¦ãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰è¨­è¨ˆã«å¤‰æ›´
- 2025-07-17: YouTubeã‚«ãƒ†ã‚´ãƒªIDã‚’è¿½åŠ ã—ã¦3å±¤ã‚¿ã‚°ã‚·ã‚¹ãƒ†ãƒ ã«ç™ºå±•
- 2025-07-17: **ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆãƒ™ãƒ¼ã‚¹ã‚¿ã‚°ï¼‹ãƒ¦ãƒ¼ã‚¶ãƒ¼ç·¨é›†å¯èƒ½ã‚¿ã‚°ã®4å±¤ã‚·ã‚¹ãƒ†ãƒ ã«æ‹¡å¼µ**
  - ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆã‚¿ã‚°ã®è‡ªå‹•ç”Ÿæˆæ©Ÿèƒ½ã‚’è¿½åŠ 
  - ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ã‚ˆã‚‹æ‰‹å‹•ã‚¿ã‚°ç·¨é›†æ©Ÿèƒ½ã‚’è¿½åŠ 
  - ç·¨é›†å±¥æ­´ãƒ»ãƒ¢ãƒ‡ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³æ©Ÿèƒ½ã‚’è¿½åŠ 
  - 4å±¤ã‚¿ã‚°ã®æ¨©é™ä½“ç³»ãƒ»UIè¨­è¨ˆã‚’å®Œå‚™
- 2025-07-17: **ãƒˆãƒ”ãƒƒã‚¯ã‚«ãƒ†ã‚´ãƒªã‚’å‰Šé™¤ã—ã¦3å±¤ã‚·ã‚¹ãƒ†ãƒ ã«ç°¡ç´ åŒ–**
  - ãƒˆãƒ”ãƒƒã‚¯ã‚«ãƒ†ã‚´ãƒªã®æ—¥æœ¬èªåŒ–ã®å›°é›£ã•ã‚’è€ƒæ…®ã—å‰Šé™¤
  - ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆãƒ»ã‚«ãƒ†ã‚´ãƒªIDãƒ»ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¿ã‚°ã®3å±¤ã‚·ã‚¹ãƒ†ãƒ ã«ç¢ºå®š
- 2025-07-17: **ã‚¿ã‚°ç·¨é›†å±¥æ­´æ©Ÿèƒ½ã‚’å‰Šé™¤ã—ã¦ã•ã‚‰ã«ç°¡ç´ åŒ–**
  - å®Ÿè£…ã®è¤‡é›‘æ€§ã‚’è€ƒæ…®ã—ç·¨é›†å±¥æ­´æ©Ÿèƒ½ã‚’ã‚¹ã‚³ãƒ¼ãƒ—å¤–ã«
  - ã‚·ãƒ³ãƒ—ãƒ«ãªç›´æ¥ç·¨é›†æ–¹å¼ã«å¤‰æ›´
  - ãƒ¢ãƒ‡ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³æ©Ÿèƒ½ã‚‚åŸºæœ¬çš„ãªã‚‚ã®ã®ã¿ã«ç°¡ç´ åŒ–
- 2025-07-17: **åŸºæœ¬ãƒ¢ãƒ‡ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³æ©Ÿèƒ½ã‚‚å‰Šé™¤ã—ã¦å®Œå…¨ä¿¡é ¼ãƒ™ãƒ¼ã‚¹ã«**
  - ä¸é©åˆ‡èªå¥æ¤œå‡ºãƒ»ãƒ¬ãƒ¼ãƒˆåˆ¶é™ã‚’å‰Šé™¤
  - èªè¨¼ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’å®Œå…¨ã«ä¿¡ç”¨ã™ã‚‹ã‚·ãƒ³ãƒ—ãƒ«ãªå®Ÿè£…
  - å®Ÿè£…æœŸé–“ã¨ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹è² è·ã‚’æœ€å°åŒ–
- 2025-07-17: **ã‚¿ã‚°æ¨è–¦æ©Ÿèƒ½ã‚‚å°†æ¥å®Ÿè£…ã«å»¶æœŸ**
  - åˆæœŸå®Ÿè£…ã®è¤‡é›‘æ€§ã‚’å›é¿
  - Phase 6ï¼ˆå°†æ¥ã®æ‹¡å¼µæ©Ÿèƒ½ï¼‰ã¨ã—ã¦åˆ†é›¢
  - æœ€å°é™ã®æ©Ÿèƒ½ã§ç¢ºå®Ÿãªå®Ÿè£…ã‚’å„ªå…ˆ
- 2025-07-17: **ğŸ”„ fetchYoutubeVideosçµ±åˆè¨­è¨ˆã«æ›´æ–°**
  - æ—¢å­˜ã®YouTube APIåŸºç›¤ï¼ˆ`youtube-api.ts`ã€`youtube-quota-monitor.ts`ï¼‰ã¨ã®çµ±åˆ
  - Cloud Functions `fetchYouTubeVideos`é–¢æ•°ã¸ã®ç›´æ¥çµ±åˆ
  - æ—¢å­˜ã‚¯ã‚©ãƒ¼ã‚¿ç®¡ç†ãƒ»ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ãƒ»ãƒ­ã‚°æ©Ÿèƒ½ã®æ´»ç”¨
  - é–‹ç™ºæœŸé–“çŸ­ç¸®ã¨å“è³ªå‘ä¸Šã‚’ä¸¡ç«‹
- 2025-07-17: **ğŸ¯ Phase 1-3å®Ÿè£…å®Œäº†**
  - YouTube APIçµ±åˆãƒ»ãƒ‡ãƒ¼ã‚¿ã‚¹ã‚­ãƒ¼ãƒæ‹¡å¼µå®Œäº†ï¼ˆPhase 1ï¼‰
  - ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¿ã‚°ç·¨é›†æ©Ÿèƒ½å®Ÿè£…å®Œäº†ï¼ˆPhase 2ï¼‰
  - 3å±¤ã‚¿ã‚°è¡¨ç¤ºUIå®Ÿè£…å®Œäº†ï¼ˆPhase 3ï¼‰
  - ThreeLayerTagDisplayãƒ»YouTube ã‚«ãƒ†ã‚´ãƒªæ—¥æœ¬èªåŒ–å®Ÿè£…
  - å‹•ç”»è©³ç´°ãƒ»ä¸€è¦§ç”»é¢ã§ã®3å±¤ã‚¿ã‚°è¡¨ç¤ºé–‹å§‹

> **âœ… Phase 3å®Ÿè£…å®Œäº†**: 3å±¤ã‚¿ã‚°ã‚·ã‚¹ãƒ†ãƒ ï¼ˆãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆãƒ»ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ»ã‚«ãƒ†ã‚´ãƒªï¼‰ã®UIãŒå®Œå…¨å®Ÿè£…ã•ã‚Œã€å‹•ç”»è©³ç´°ãƒ»ä¸€è¦§ç”»é¢ã§ç¨¼åƒé–‹å§‹ã€‚èªè¨¼ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ã‚ˆã‚‹ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¿ã‚°ç·¨é›†æ©Ÿèƒ½ã‚‚åˆ©ç”¨å¯èƒ½ã€‚