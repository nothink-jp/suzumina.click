# Claude Codeé€£æºãƒ–ãƒ©ãƒ³ãƒæˆ¦ç•¥ãƒ¬ãƒ“ãƒ¥ãƒ¼

## ğŸ“‹ æ¦‚è¦

æœ¬ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¯ã€suzumina.clickãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«ãŠã‘ã‚‹Claude Codeã¨ã®å”åƒé–‹ç™ºã‚’å‰æã¨ã—ãŸã€åŠ¹ç‡çš„ãªãƒ–ãƒ©ãƒ³ãƒæˆ¦ç•¥ã¨CI/CDãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³æœ€é©åŒ–ã®ææ¡ˆã‚’ã¾ã¨ã‚ãŸã‚‚ã®ã§ã™ã€‚

## ğŸ¯ ç¾çŠ¶ã®èª²é¡Œ

### CI/CDã‚³ã‚¹ãƒˆå•é¡Œ

- **éå‰°ãªãƒ‡ãƒ—ãƒ­ã‚¤ãƒˆãƒªã‚¬ãƒ¼**: packagesé…ä¸‹ã®å¤‰æ›´ã§å…¨ã‚¢ãƒ—ãƒªãŒãƒ‡ãƒ—ãƒ­ã‚¤
- **å†—é•·ãªãƒ†ã‚¹ãƒˆå®Ÿè¡Œ**: å„ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã§åŒã˜ãƒ†ã‚¹ãƒˆã‚’é‡è¤‡å®Ÿè¡Œ
- **éåº¦ãªã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¹ã‚­ãƒ£ãƒ³**: å€‹äººé–‹ç™ºã«ã¯ä¸è¦ãªæ¯æ—¥å®Ÿè¡Œ
- **é•·æœŸã‚¢ãƒ¼ãƒ†ã‚£ãƒ•ã‚¡ã‚¯ãƒˆä¿æŒ**: 30-90æ—¥é–“ã®ä¿æŒã«ã‚ˆã‚‹ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã‚³ã‚¹ãƒˆ

### é–‹ç™ºãƒ•ãƒ­ãƒ¼

- ç¾åœ¨: mainãƒ–ãƒ©ãƒ³ãƒç›´æ¥é–‹ç™º
- èª²é¡Œ: å±¥æ­´ç®¡ç†ãƒ»ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯ãƒ»ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ç’°å¢ƒã®æ¬ å¦‚

## ğŸš€ ææ¡ˆã™ã‚‹æˆ¦ç•¥

### 1. Session Branchæˆ¦ç•¥

#### åŸºæœ¬ãƒ«ãƒ¼ãƒ«

```bash
# ã‚»ãƒƒã‚·ãƒ§ãƒ³é–‹å§‹æ™‚
git checkout -b session/$(date +%Y%m%d-%H%M)

# ã‚»ãƒƒã‚·ãƒ§ãƒ³çµ‚äº†æ™‚
git checkout main && git merge --no-ff session/20250630-1430
git push origin main
git branch -d session/20250630-1430
```

#### åˆ©ç‚¹

- èªçŸ¥è² è·æœ€å°ï¼ˆãƒ–ãƒ©ãƒ³ãƒåã‚’è€ƒãˆãªã„ï¼‰
- Claude Codeã‚»ãƒƒã‚·ãƒ§ãƒ³å˜ä½ã§å±¥æ­´ç®¡ç†
- ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯å®¹æ˜“
- ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ç’°å¢ƒã¨ã®é€£æº

### 2. ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ç’°å¢ƒè‡ªå‹•æ§‹ç¯‰

#### ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

```text
session/* ãƒ–ãƒ©ãƒ³ãƒ â†’ GitHub Actions â†’ Cloud Run Preview â†’ è‡ªå‹•URLç”Ÿæˆ
                                                      â†’ 24æ™‚é–“å¾Œè‡ªå‹•å‰Šé™¤
```

#### å®Ÿè£…å†…å®¹

- **Terraform**: ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ç”¨ã‚µãƒ¼ãƒ“ã‚¹ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãƒ»æ¨©é™è¨­å®š
- **GitHub Actions**: è‡ªå‹•ãƒ“ãƒ«ãƒ‰ãƒ»ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ»URLé€šçŸ¥
- **è‡ªå‹•ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—**: 24æ™‚é–“çµŒéãƒ»ãƒ–ãƒ©ãƒ³ãƒå‰Šé™¤æ™‚ã«ç’°å¢ƒå‰Šé™¤

#### ã‚³ã‚¹ãƒˆæœ€é©åŒ–

```yaml
min-instances: 0  # ä½¿ç”¨æ™‚ã®ã¿èµ·å‹•
max-instances: 1  # å˜ä¸€ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹  
memory: 512Mi     # æœ€å°ãƒ¡ãƒ¢ãƒª
cpu: 1            # æœ€å°CPU
```

### 3. Claude Codeè‡ªå‹•ãƒ–ãƒ©ãƒ³ãƒä½œæˆ

#### CLAUDE.mdæŒ‡ç¤º

```markdown
## ã‚¿ã‚¹ã‚¯é–‹å§‹æ‰‹é †
1. git checkout main && git pull
2. git checkout -b [type]/[task]-$(date +%Y%m%d-%H%M)
   - feature/: æ–°æ©Ÿèƒ½
   - fix/: ãƒã‚°ä¿®æ­£
   - docs/: ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
   - chore/: ãã®ä»–
```

#### å®‰å…¨å¯¾ç­–

- Git hooks: mainãƒ–ãƒ©ãƒ³ãƒã‚³ãƒŸãƒƒãƒˆæ™‚ã®è­¦å‘Šãƒ»è‡ªå‹•ãƒ–ãƒ©ãƒ³ãƒä½œæˆ
- VS Codeçµ±åˆ: ã‚¿ã‚¹ã‚¯ãƒ»ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«è¨­å®š
- GitHub Actions: mainã¸ã®ç›´æ¥pushæ¤œçŸ¥

### 4. CI/CDæœ€é©åŒ–

#### æ”¹å–„æ¡ˆ

1. **ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸åˆ¥ãƒˆãƒªã‚¬ãƒ¼**
   ```yaml
   paths:
     - 'apps/web/**'
     - 'packages/shared-types/**'  # ç›´æ¥å½±éŸ¿ã®ã¿
   ```

2. **çµ±åˆCI/CDãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼**
   - PRæ™‚: è»½é‡ãƒã‚§ãƒƒã‚¯ï¼ˆå¤‰æ›´ãƒ•ã‚¡ã‚¤ãƒ«ã®ã¿ï¼‰
   - mainæ™‚: å®Œå…¨ãƒã‚§ãƒƒã‚¯ï¼‹ãƒ‡ãƒ—ãƒ­ã‚¤

3. **ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«èª¿æ•´**
   - ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¹ã‚­ãƒ£ãƒ³: é€±1å›
   - ã‚¢ãƒ¼ãƒ†ã‚£ãƒ•ã‚¡ã‚¯ãƒˆä¿æŒ: 7æ—¥é–“

## ğŸ“Š æœŸå¾…ã•ã‚Œã‚‹åŠ¹æœ

### é–‹ç™ºåŠ¹ç‡

- **é–‹ç™ºé€Ÿåº¦**: ç¾çŠ¶ã¨ã»ã¼åŒç­‰ï¼ˆ3-7åˆ†/ã‚µã‚¤ã‚¯ãƒ«ï¼‰
- **å“è³ªå‘ä¸Š**: ãƒ–ãƒ©ãƒ³ãƒä¿è­·ãƒ»è‡ªå‹•ãƒ†ã‚¹ãƒˆ
- **ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ç¢ºèª**: å³åº§ã«å®Ÿè£…ç¢ºèªå¯èƒ½

### ã‚³ã‚¹ãƒˆå‰Šæ¸›

- **GitHub Actionså®Ÿè¡Œæ™‚é–“**: 40-60%å‰Šæ¸›
- **Container Registryä½¿ç”¨é‡**: 30%å‰Šæ¸›
- **ã‚¢ãƒ¼ãƒ†ã‚£ãƒ•ã‚¡ã‚¯ãƒˆã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸**: 70%å‰Šæ¸›
- **ä¸è¦ãªCloud Runãƒ‡ãƒ—ãƒ­ã‚¤**: 80%å‰Šæ¸›

## ğŸ”„ æ®µéšçš„å°å…¥è¨ˆç”»

### Phase 1: åŸºæœ¬è¨­å®šï¼ˆ1é€±é–“ï¼‰

1. CLAUDE.mdæ›´æ–° - ãƒ–ãƒ©ãƒ³ãƒä½œæˆãƒ«ãƒ¼ãƒ«è¨˜è¼‰
2. Git aliasesè¨­å®š - claude-start/claude-done
3. è»½é‡PR workflowä½œæˆ

### Phase 2: ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ç’°å¢ƒï¼ˆ2é€±é–“ï¼‰

1. Terraformè¨­å®š - ã‚µãƒ¼ãƒ“ã‚¹ã‚¢ã‚«ã‚¦ãƒ³ãƒˆä½œæˆ
2. preview-deploy.ymlä½œæˆ
3. è‡ªå‹•ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—è¨­å®š

### Phase 3: å®Œå…¨ç§»è¡Œï¼ˆ3é€±é–“ã€œï¼‰

1. CI/CDãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼æœ€é©åŒ–
2. mainãƒ–ãƒ©ãƒ³ãƒä¿è­·ãƒ«ãƒ¼ãƒ«
3. é‹ç”¨ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ•´å‚™

## ğŸ¯ æ¨å¥¨ã‚¢ã‚¯ã‚·ãƒ§ãƒ³

### å³æ™‚å®Ÿæ–½å¯èƒ½

1. Git aliasesã®è¨­å®š
2. CLAUDE.mdã¸ã®ãƒ–ãƒ©ãƒ³ãƒãƒ«ãƒ¼ãƒ«è¿½åŠ 
3. ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¹ã‚­ãƒ£ãƒ³é »åº¦å¤‰æ›´ï¼ˆdaily â†’ weeklyï¼‰

### çŸ­æœŸå®Ÿæ–½ï¼ˆ1-2é€±é–“ï¼‰

1. Session Branchæˆ¦ç•¥ã®è©¦é¨“é‹ç”¨
2. ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ç’°å¢ƒã®Terraform/Actionsè¨­å®š
3. CI/CDãƒˆãƒªã‚¬ãƒ¼æ¡ä»¶ã®è¦‹ç›´ã—

### ä¸­æœŸå®Ÿæ–½ï¼ˆ1ãƒ¶æœˆï¼‰

1. å®Œå…¨ãªãƒ–ãƒ©ãƒ³ãƒæˆ¦ç•¥ç§»è¡Œ
2. CI/CDãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³çµ±åˆ
3. ã‚³ã‚¹ãƒˆåŠ¹æœæ¸¬å®šãƒ»èª¿æ•´

## ğŸ’¡ è€ƒæ…®äº‹é …

### ãƒ¡ãƒªãƒƒãƒˆ

- æœ€å°é™ã®èªçŸ¥è² è·ã§ãƒ—ãƒ­ã‚»ã‚¹æ”¹å–„
- Claude Codeã¨ã®ç›¸æ€§ãŒè‰¯ã„
- æ®µéšçš„å°å…¥ãŒå¯èƒ½
- å³åº§ã«ã‚³ã‚¹ãƒˆå‰Šæ¸›åŠ¹æœ

### æ³¨æ„ç‚¹

- åˆæœŸè¨­å®šã®æ‰‹é–“
- ãƒãƒ¼ãƒ é–‹ç™ºæ™‚ã¯èª¿æ•´å¿…è¦
- ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ç’°å¢ƒã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è€ƒæ…®

## ğŸ”’ GitHubãƒ–ãƒ©ãƒ³ãƒãƒ—ãƒ­ãƒ†ã‚¯ã‚·ãƒ§ãƒ³ãƒ«ãƒ¼ãƒ«

### å€‹äººé–‹ç™ºå‘ã‘è»½é‡è¨­å®š

#### mainãƒ–ãƒ©ãƒ³ãƒä¿è­·ï¼ˆæœ€å°æ§‹æˆï¼‰

```yaml
# GitHub Settings > Branches > Add rule
Branch name pattern: main

âœ… Require a pull request before merging
  â˜ Require approvals (å€‹äººé–‹ç™ºã§ã¯ä¸è¦)
  âœ… Dismiss stale pull request approvals when new commits are pushed
  â˜ Require review from CODEOWNERS (ä¸è¦)

âœ… Require status checks to pass before merging
  âœ… Require branches to be up to date before merging
  é¸æŠã™ã‚‹ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒã‚§ãƒƒã‚¯:
    - typecheck (å¿…é ˆ)
    - lint (å¿…é ˆ)
    - test (æ¨å¥¨)

â˜ Require conversation resolution before merging (å€‹äººé–‹ç™ºã§ã¯ä¸è¦)

âœ… Include administrators (è‡ªåˆ†ã‚‚å«ã‚ã¦ä¿è­·)

âœ… Allow force pushes
  âœ… Specify who can force push: è‡ªåˆ†ã®ã¿
  ç†ç”±: ç·Šæ€¥æ™‚ã®ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯ç”¨

â˜ Allow deletions (mainãƒ–ãƒ©ãƒ³ãƒå‰Šé™¤ã¯ç¦æ­¢)
```

#### è‡ªå‹•ãƒãƒ¼ã‚¸è¨­å®š

```yaml
# PRè¨­å®šã§æœ‰åŠ¹åŒ–
âœ… Allow auto-merge
âœ… Automatically delete head branches (ãƒãƒ¼ã‚¸å¾Œã®ãƒ–ãƒ©ãƒ³ãƒè‡ªå‹•å‰Šé™¤)
```

### Claude Codeé€£æºæœ€é©åŒ–

#### æ¨å¥¨è¨­å®šã®ç†ç”±

1. **æœ€å°é™ã®ä¿è­·**
   - ãƒ¬ãƒ“ãƒ¥ãƒ¼æ‰¿èªã¯ä¸è¦ï¼ˆå€‹äººé–‹ç™ºï¼‰
   - åŸºæœ¬çš„ãªå“è³ªãƒã‚§ãƒƒã‚¯ã®ã¿å¿…é ˆ
   - è‡ªåˆ†è‡ªèº«ã‚‚ä¿è­·å¯¾è±¡ï¼ˆèª¤æ“ä½œé˜²æ­¢ï¼‰

2. **ç·Šæ€¥å¯¾å¿œã®ä½™åœ°**
   - Force pushã¯è‡ªåˆ†ã®ã¿è¨±å¯
   - ç·Šæ€¥hotfixã®ãŸã‚ã®æŸ”è»Ÿæ€§ç¢ºä¿

3. **è‡ªå‹•åŒ–ã¨ã®ç›¸æ€§**
   - Auto-mergeã§Claude Codeä½œæ¥­ã‚’åŠ¹ç‡åŒ–
   - ãƒ–ãƒ©ãƒ³ãƒè‡ªå‹•å‰Šé™¤ã§ç®¡ç†è² è·å‰Šæ¸›

### æ®µéšçš„å°å…¥ãƒ—ãƒ©ãƒ³

#### Phase 1: ä¿è­·ãªã—é‹ç”¨ï¼ˆç¾åœ¨ï¼‰
```
- ãƒ–ãƒ©ãƒ³ãƒä¿è­·ãƒ«ãƒ¼ãƒ«ãªã—
- ç›´æ¥mainã¸push
```

#### Phase 2: è»½é‡ä¿è­·ï¼ˆæ¨å¥¨é–‹å§‹åœ°ç‚¹ï¼‰
```yaml
âœ… Require status checks (typecheck, lint)
âœ… Include administrators
âœ… Allow force pushes (è‡ªåˆ†ã®ã¿)
```

#### Phase 3: æ¨™æº–ä¿è­·ï¼ˆå®‰å®šå¾Œï¼‰
```yaml
âœ… Require pull request
âœ… Require status checks
âœ… Auto-merge enabled
```

### ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è€ƒæ…®äº‹é …

#### ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆãƒªãƒã‚¸ãƒˆãƒªã®å ´åˆ

```yaml
# æœ€å°é™ã®è¨­å®šã§ååˆ†
- Status checks: typecheck, lint
- Force push: è‡ªåˆ†ã®ã¿
- PRå¿…é ˆ: ä»»æ„
```

#### ãƒ‘ãƒ–ãƒªãƒƒã‚¯ãƒªãƒã‚¸ãƒˆãƒªç§»è¡Œæ™‚

```yaml
# ã‚ˆã‚Šå³æ ¼ãªè¨­å®šã«å¤‰æ›´
âœ… Require pull request reviews (1äººä»¥ä¸Š)
âœ… Dismiss stale reviews
âœ… Restrict who can push (ç‰¹å®šãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ã¿)
â˜ Allow force pushes (ç„¡åŠ¹åŒ–)
```

### GitHub CLIæ´»ç”¨

```bash
# ãƒ–ãƒ©ãƒ³ãƒä¿è­·ãƒ«ãƒ¼ãƒ«è¨­å®šï¼ˆCLIï¼‰
gh api repos/:owner/:repo/branches/main/protection \
  --method PUT \
  --field required_status_checks='{"strict":true,"contexts":["typecheck","lint"]}' \
  --field enforce_admins=true \
  --field required_pull_request_reviews=null \
  --field restrictions=null
```

### ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

#### ã‚ˆãã‚ã‚‹å•é¡Œã¨è§£æ±ºç­–

1. **ã€ŒStatus checks failingã€ã‚¨ãƒ©ãƒ¼**
   ```bash
   # ãƒ­ãƒ¼ã‚«ãƒ«ã§äº‹å‰ãƒã‚§ãƒƒã‚¯
   pnpm typecheck && pnpm lint
   ```

2. **ãƒãƒ¼ã‚¸ã§ããªã„å ´åˆ**
   ```bash
   # ãƒ–ãƒ©ãƒ³ãƒã‚’æœ€æ–°ã«
   git checkout feature/branch
   git rebase main
   git push --force-with-lease
   ```

3. **ç·Šæ€¥æ™‚ã®ãƒã‚¤ãƒ‘ã‚¹**
   ```bash
   # ç®¡ç†è€…æ¨©é™ã§force push
   git push --force origin main
   ```

## ğŸ“ æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—

1. **æ„æ€æ±ºå®š**: ã©ã®æˆ¦ç•¥ã‚’æ¡ç”¨ã™ã‚‹ã‹
2. **å„ªå…ˆé †ä½**: å®Ÿè£…é †åºã®æ±ºå®š
3. **å®Ÿè£…é–‹å§‹**: é¸æŠã—ãŸé …ç›®ã‹ã‚‰ç€æ‰‹
4. **ãƒ–ãƒ©ãƒ³ãƒä¿è­·**: æ®µéšçš„ã«å°å…¥

---

*ã“ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¯2025å¹´6æœˆ30æ—¥æ™‚ç‚¹ã®ææ¡ˆã§ã™ã€‚ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®æˆé•·ã«å¿œã˜ã¦æˆ¦ç•¥ã®è¦‹ç›´ã—ã‚’æ¨å¥¨ã—ã¾ã™ã€‚*
