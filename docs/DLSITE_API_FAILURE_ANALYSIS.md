# DLsite Individual Info API å¤±æ•—åˆ†æãƒ»å¯¾ç­–æ¡ˆãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

> **ğŸ“… ä½œæˆæ—¥**: 2025å¹´7æœˆ10æ—¥  
> **ğŸ“Š å¯¾è±¡**: Cloud Functionsç’°å¢ƒã§ã® Individual Info API å¤±æ•—ç‡ 26% (78/300ä»¶)  
> **ğŸ¯ ç›®æ¨™**: ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒã§æˆåŠŸã™ã‚‹ãƒ‡ãƒ¼ã‚¿ã‚’Cloud Firestoreã«æ ¼ç´ã™ã‚‹ä»•çµ„ã¿æ§‹ç¯‰  
> **ğŸ“‹ å®Ÿè£…ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹**: âœ… **Phase 1-3 å®Œäº†** - ãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰åé›†ã‚·ã‚¹ãƒ†ãƒ  + ç›£è¦–ãƒ»é€šçŸ¥ã‚·ã‚¹ãƒ†ãƒ å®Ÿè£…æ¸ˆã¿

## ğŸš¨ å•é¡Œã®æ¦‚è¦

### ç¾çŠ¶ã®å¤±æ•—ç‡
- **Cloud Functions**: 222/300ä»¶æˆåŠŸ (74.0%æˆåŠŸç‡ã€26.0%å¤±æ•—ç‡)
- **ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒ**: åŒä¸€ä½œå“IDã§æ­£å¸¸å–å¾—å¯èƒ½
- **å¤±æ•—ä½œå“æ•°**: 78ä»¶ (2025å¹´7æœˆ10æ—¥ 01:04 JST)

### å¤±æ•—ãƒ‘ã‚¿ãƒ¼ãƒ³ã®ç‰¹å¾´
1. **ä¸€åº¦å¤±æ•—ã—ãŸä½œå“IDã¯ç¶™ç¶šçš„ã«å¤±æ•—**
2. **åœ°åŸŸåˆ¶é™ã®å¯èƒ½æ€§**: Cloud Functions (us-central1) vs ãƒ­ãƒ¼ã‚«ãƒ« (æ—¥æœ¬)
3. **ãƒ¬ãƒ¼ãƒˆåˆ¶é™ãƒ»IPåˆ¶é™ã®å¯èƒ½æ€§**: DLsiteå´ã®APIåˆ¶é™

## ğŸ“‹ å¤±æ•—ä½œå“IDä¸€è¦§ (78ä»¶)

### ãƒãƒƒãƒ1å¤±æ•—ä½œå“ (50ä»¶)
```
RJ01001102, RJ01001104, RJ01004682, RJ01005852, RJ01008923, 
RJ01011086, RJ01011411, RJ01012105, RJ01014068, RJ01020181, 
RJ01022104, RJ01022763, RJ01024339, RJ01024956, RJ01024958, 
RJ01024960, RJ01027141, RJ01027182, RJ01032910, RJ01037463, 
RJ01037677, RJ01039482, RJ01050360, RJ01050363, RJ01051286, 
RJ01051302, RJ01051310, RJ01051337, RJ01051351, RJ01051859, 
RJ01053268, RJ01053422, RJ01053969, RJ01058465, RJ01063306, 
RJ01064664, RJ01065526, RJ01066828, RJ01069632, RJ01072399, 
RJ01072536, RJ01072981, RJ01076253, RJ01077764, RJ01078989, 
RJ01078993, RJ01078996, RJ01078998, RJ01079239, RJ01080076
```

### ãƒãƒƒãƒ2å¤±æ•—ä½œå“ (28ä»¶)
```
RJ01081155, RJ01081182, RJ01081190, RJ01081202, RJ01084276, 
RJ01084869, RJ01093241, RJ01093313, RJ01094881, RJ01095149, 
RJ01095756, RJ01099196, RJ01099239, RJ01099263, RJ01099266, 
RJ01101951, RJ01105472, RJ01107853, RJ01112968, RJ01113174, 
RJ01114861, RJ01115505, RJ01116497, RJ01116995, RJ01117246, 
RJ01122461, RJ01122687, RJ01123784
```

## ğŸ” åŸå› åˆ†æ

### 1. åœ°åŸŸåˆ¶é™ä»®èª¬ (æœ€æœ‰åŠ›)
**Cloud Functionså®Ÿè¡Œç’°å¢ƒ**: us-central1 (ã‚¢ãƒ¡ãƒªã‚«)  
**ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™ºç’°å¢ƒ**: æ—¥æœ¬å›½å†…  

**æ¤œè¨¼æ–¹æ³•**:
- å¤±æ•—ä½œå“IDã‚’ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒã§ãƒ†ã‚¹ãƒˆ â†’ æˆåŠŸ
- åœ°åŸŸåˆ¥ã‚¢ã‚¯ã‚»ã‚¹åˆ¶é™ã®å¯èƒ½æ€§ãŒé«˜ã„

### 2. IPãƒ»User-Agentåˆ¶é™ä»®èª¬
**Cloud Functions**: 
- Google Cloud IPç¯„å›²ã‹ã‚‰ã®ã‚¢ã‚¯ã‚»ã‚¹
- å¤§é‡åŒæ™‚ãƒªã‚¯ã‚¨ã‚¹ãƒˆã«ã‚ˆã‚‹ãƒ¬ãƒ¼ãƒˆåˆ¶é™
- User-Agentè­˜åˆ¥ã«ã‚ˆã‚‹åˆ¶é™

### 3. ä½œå“å›ºæœ‰åˆ¶é™ä»®èª¬
**ç‰¹å®šä½œå“ã®åˆ¶é™**:
- åœ°åŸŸé™å®šè²©å£²ä½œå“
- å¹´é½¢åˆ¶é™ãƒ»å†…å®¹åˆ¶é™ã«ã‚ˆã‚‹è¡¨ç¤ºåˆ¶é™
- è²©å£²åœæ­¢ãƒ»éå…¬é–‹çŠ¶æ…‹

## ğŸ› ï¸ å¯¾ç­–æ¡ˆ

### æ¡ˆ1: ãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰åé›†ã‚·ã‚¹ãƒ†ãƒ  ã€æ¨å¥¨ã€‘

#### æ¦‚è¦
Cloud Functions + ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒã§ã®è£œå®Œçš„ãƒ‡ãƒ¼ã‚¿åé›†

#### å®Ÿè£…ã‚¢ãƒ—ãƒ­ãƒ¼ãƒ
```typescript
// 1. Cloud Functions: é€šå¸¸ã®è‡ªå‹•åé›†
const cloudFunctionResults = await fetchDLsiteWorksIndividualAPI();

// 2. å¤±æ•—ä½œå“IDã®è¨˜éŒ²ãƒ»ç®¡ç†
const failedWorkIds = cloudFunctionResults.failedIds;

// 3. ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒ: å¤±æ•—ä½œå“ã®è£œå®Œåé›†
const localResults = await fetchFailedWorksLocally(failedWorkIds);

// 4. Cloud Firestore: ãƒ‡ãƒ¼ã‚¿çµ±åˆãƒ»ä¿å­˜
await saveSupplementalData(localResults);
```

#### ãƒ¡ãƒªãƒƒãƒˆ
- **å®Œå…¨æ€§**: åœ°åŸŸåˆ¶é™ã‚’å›é¿ã—ã¦å…¨ä½œå“ãƒ‡ãƒ¼ã‚¿åé›†
- **è‡ªå‹•åŒ–**: Cloud Functionsç¶™ç¶š + æ‰‹å‹•è£œå®Œ
- **ãƒ‡ãƒ¼ã‚¿ä¸€è²«æ€§**: åŒä¸€ãƒ‡ãƒ¼ã‚¿æ§‹é€ ã§ã®çµ±åˆä¿å­˜

#### ãƒ‡ãƒ¡ãƒªãƒƒãƒˆ
- **æ‰‹å‹•æ“ä½œ**: å®šæœŸçš„ãªãƒ­ãƒ¼ã‚«ãƒ«å®Ÿè¡ŒãŒå¿…è¦
- **è¤‡é›‘æ€§**: 2ã¤ã®å®Ÿè¡Œç’°å¢ƒç®¡ç†

### æ¡ˆ2: ãƒ—ãƒ­ã‚­ã‚·ãƒ»VPNçµŒç”±åé›†

#### æ¦‚è¦
Cloud Functions ã‹ã‚‰æ—¥æœ¬å›½å†…ãƒ—ãƒ­ã‚­ã‚·çµŒç”±ã§ã‚¢ã‚¯ã‚»ã‚¹

#### å®Ÿè£…æ–¹æ³•
```typescript
// ãƒ—ãƒ­ã‚­ã‚·è¨­å®š
const httpsAgent = new HttpsProxyAgent('http://japan-proxy:8080');
const response = await fetch(INDIVIDUAL_INFO_API_URL, {
  agent: httpsAgent,
  headers: { 'User-Agent': JAPAN_USER_AGENT }
});
```

#### ãƒ¡ãƒªãƒƒãƒˆ
- **å®Œå…¨è‡ªå‹•åŒ–**: Cloud Functionså†…ã§å®Œçµ
- **åœ°åŸŸåˆ¶é™å›é¿**: æ—¥æœ¬IPã§ã®ã‚¢ã‚¯ã‚»ã‚¹

#### ãƒ‡ãƒ¡ãƒªãƒƒãƒˆ
- **ã‚³ã‚¹ãƒˆ**: ãƒ—ãƒ­ã‚­ã‚·ã‚µãƒ¼ãƒ“ã‚¹æ–™é‡‘
- **è¤‡é›‘æ€§**: ãƒ—ãƒ­ã‚­ã‚·è¨­å®šãƒ»ç®¡ç†
- **ä¿¡é ¼æ€§**: ãƒ—ãƒ­ã‚­ã‚·éšœå®³ãƒªã‚¹ã‚¯

### æ¡ˆ3: Cloud Functions asia-northeast1 ç§»è¡Œ

#### æ¦‚è¦
Cloud Functions ã‚’æ—¥æœ¬ãƒªãƒ¼ã‚¸ãƒ§ãƒ³ (asia-northeast1) ã«ç§»è¡Œ

#### å®Ÿè£…æ‰‹é †
```bash
# æ–°è¦ Cloud Functions ãƒ‡ãƒ—ãƒ­ã‚¤
gcloud functions deploy fetchDLsiteWorksIndividualAPI \
  --region=asia-northeast1 \
  --runtime=nodejs22 \
  --source=.
```

#### ãƒ¡ãƒªãƒƒãƒˆ
- **åœ°åŸŸåˆ¶é™è§£æ±º**: æ—¥æœ¬ãƒªãƒ¼ã‚¸ãƒ§ãƒ³ã‹ã‚‰ã®ã‚¢ã‚¯ã‚»ã‚¹
- **æœ€å°å¤‰æ›´**: æ—¢å­˜ã‚³ãƒ¼ãƒ‰æµç”¨å¯èƒ½
- **è‡ªå‹•åŒ–ç¶™ç¶š**: ç¾åœ¨ã®ä»•çµ„ã¿ç¶­æŒ

#### ãƒ‡ãƒ¡ãƒªãƒƒãƒˆ
- **ãƒ¬ã‚¤ãƒ†ãƒ³ã‚·**: ä»–ã‚µãƒ¼ãƒ“ã‚¹ã¨ã®é€šä¿¡é…å»¶
- **ã‚³ã‚¹ãƒˆ**: ãƒªãƒ¼ã‚¸ãƒ§ãƒ³é–“ãƒ‡ãƒ¼ã‚¿è»¢é€æ–™é‡‘
- **ä¸ç¢ºå®Ÿæ€§**: ãƒªãƒ¼ã‚¸ãƒ§ãƒ³ç§»è¡Œã—ã¦ã‚‚è§£æ±ºã—ãªã„å¯èƒ½æ€§

### æ¡ˆ4: Cloud Run Jobs ãƒ­ãƒ¼ã‚«ãƒ«å®Ÿè¡Œé¢¨ ã€æŠ€è¡“çš„è§£æ±ºã€‘

#### æ¦‚è¦
Cloud Run Jobs ã§æ—¥æœ¬ãƒªãƒ¼ã‚¸ãƒ§ãƒ³ + ã‚«ã‚¹ã‚¿ãƒ ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯è¨­å®š

#### å®Ÿè£…æ–¹æ³•
```yaml
# cloud-run-job.yaml
apiVersion: run.googleapis.com/v1
kind: Job
metadata:
  name: dlsite-data-collector
spec:
  spec:
    template:
      spec:
        template:
          spec:
            containers:
            - image: gcr.io/PROJECT/dlsite-collector
              env:
              - name: REGION
                value: "asia-northeast1"
```

#### ãƒ¡ãƒªãƒƒãƒˆ
- **ãƒ•ãƒ«åˆ¶å¾¡**: ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ãƒ»ç’°å¢ƒå®Œå…¨åˆ¶å¾¡
- **ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«å®Ÿè¡Œ**: Cronçš„ãªå®šæœŸå®Ÿè¡Œ
- **ãƒ­ã‚°ç®¡ç†**: è©³ç´°ãªå®Ÿè¡Œãƒ­ã‚°

#### ãƒ‡ãƒ¡ãƒªãƒƒãƒˆ
- **é–‹ç™ºã‚³ã‚¹ãƒˆ**: æ–°ã‚·ã‚¹ãƒ†ãƒ æ§‹ç¯‰
- **é‹ç”¨è¤‡é›‘æ€§**: Jobç®¡ç†ãƒ»ç›£è¦–

## ğŸ¯ æ¨å¥¨å®Ÿè£…: æ¡ˆ1 ãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰ã‚·ã‚¹ãƒ†ãƒ 

### âœ… Phase 1: å¤±æ•—ä½œå“æ¤œå‡ºã‚·ã‚¹ãƒ†ãƒ å¼·åŒ– (å®Ÿè£…å®Œäº†)

```typescript
// apps/functions/src/services/dlsite/failure-tracker.ts
export interface FailedWorkTracker {
  workId: string;
  failureCount: number;
  lastFailedAt: Timestamp;
  firstFailedAt: Timestamp;
  failureReason: string;
  lastSuccessfulAt?: Timestamp;
  isLocalSuccessful?: boolean;
  localCollectionAttempts?: number;
  createdAt: Timestamp;
  updatedAt: Timestamp;
}

// å¤±æ•—ç†ç”±ã‚«ãƒ†ã‚´ãƒª (å®Ÿè£…æ¸ˆã¿)
export const FAILURE_REASONS = {
  TIMEOUT: "timeout",
  NETWORK_ERROR: "network_error", 
  API_ERROR: "api_error",
  PARSING_ERROR: "parsing_error",
  RATE_LIMIT: "rate_limit",
  REGION_RESTRICTION: "region_restriction",
  UNKNOWN: "unknown",
} as const;

// å®Ÿè£…æ¸ˆã¿æ©Ÿèƒ½
export async function trackFailedWork(workId: string, reason: FailureReason, errorDetails?: string)
export async function trackMultipleFailedWorks(failures: Array<{workId: string; reason: FailureReason}>)
export async function trackWorkRecovery(workId: string)
export async function getFailedWorkIds(options?: {minFailureCount?: number; onlyUnrecovered?: boolean})
export async function getFailureStatistics()
export async function cleanupOldFailureRecords(daysToKeep = 30)
```

### âœ… Phase 2: ãƒ­ãƒ¼ã‚«ãƒ«è£œå®Œåé›†ãƒ„ãƒ¼ãƒ« (å®Ÿè£…å®Œäº†)

```typescript
// apps/functions/src/development/local-supplement-collector.ts
export async function collectFailedWorksLocally(options?: {
  maxWorks?: number;
  onlyUnrecovered?: boolean;
  minFailureCount?: number;
}): Promise<SupplementCollectionResult> {
  // 1. å¤±æ•—ä½œå“IDä¸€è¦§å–å¾—ï¼ˆãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°å¯¾å¿œï¼‰
  const failedWorks = await getFailedWorkIds({
    onlyUnrecovered: options?.onlyUnrecovered ?? true,
    minFailureCount: options?.minFailureCount ?? 1,
    limit: options?.maxWorks ?? 100,
  });
  
  // 2. ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒã§Individual Info APIå®Ÿè¡Œï¼ˆãƒãƒƒãƒå‡¦ç†ï¼‰
  const { successful, failed } = await batchFetchLocalSupplement(failedWorks);
  
  // 3. æˆåŠŸãƒ‡ãƒ¼ã‚¿ã‚’Firestoreã«ä¿å­˜
  const workDataList = batchMapIndividualInfoAPIToWorkData(successful, new Map());
  await saveWorksToFirestore(validWorkData);
  
  // 4. æˆåŠŸä½œå“ã®å›å¾©è¨˜éŒ²
  for (const work of validWorkData) {
    await trackWorkRecovery(work.productId);
  }
  
  // 5. ã¾ã å¤±æ•—ã—ã¦ã„ã‚‹ä½œå“ã®è¿½è·¡æ›´æ–°
  await trackMultipleFailedWorks(failed.map(workId => ({
    workId,
    reason: FAILURE_REASONS.REGION_RESTRICTION
  })));
}

// å®Ÿè¡Œã‚³ãƒãƒ³ãƒ‰
// pnpm --filter @suzumina.click/functions local:supplement
```

### âœ… Phase 3: ç›£è¦–ãƒ»é€šçŸ¥ã‚·ã‚¹ãƒ†ãƒ  (å®Ÿè£…å®Œäº†)

```typescript
// apps/functions/src/services/notification/email-service.ts
export class EmailNotificationService {
  // å¤±æ•—ç‡ã‚¢ãƒ©ãƒ¼ãƒˆãƒ¡ãƒ¼ãƒ«é€ä¿¡
  async sendFailureRateAlert(alert: FailureRateAlert): Promise<void>
  
  // ãƒ­ãƒ¼ã‚«ãƒ«è£œå®Œå®Ÿè¡Œçµæœãƒ¡ãƒ¼ãƒ«é€ä¿¡
  async sendSupplementResult(result: SupplementResult): Promise<void>
  
  // ã‚·ã‚¹ãƒ†ãƒ å¥å…¨æ€§ãƒ¬ãƒãƒ¼ãƒˆãƒ¡ãƒ¼ãƒ«é€ä¿¡ï¼ˆé€±æ¬¡ï¼‰
  async sendWeeklyHealthReport(stats: WeeklyHealthStats): Promise<void>
}

// apps/functions/src/services/monitoring/failure-rate-monitor.ts
export class FailureRateMonitor {
  // å¤±æ•—ç‡ãƒã‚§ãƒƒã‚¯ãƒ»ã‚¢ãƒ©ãƒ¼ãƒˆé€ä¿¡
  async checkAndAlert(): Promise<{
    shouldAlert: boolean;
    currentFailureRate: number;
    alertSent: boolean;
  }>
  
  // ç›£è¦–è¨­å®šãƒ»çµ±è¨ˆå–å¾—
  async getMonitoringStats(): Promise<MonitoringStats>
}

// Cloud Functionsçµ±åˆã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ
// apps/functions/src/endpoints/monitoring-alerts.ts - å®šæœŸç›£è¦–å®Ÿè¡Œ
// apps/functions/src/endpoints/supplement-notification.ts - é€šçŸ¥API

// å®Ÿè¡Œã‚³ãƒãƒ³ãƒ‰
// pnpm --filter @suzumina.click/functions monitor:failure-rate
// pnpm --filter @suzumina.click/functions notify:weekly-report
```

### Phase 3: çµ±åˆç®¡ç†ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹

```typescript
// apps/admin/src/pages/data-management/supplement.tsx
export default function SupplementDataPage() {
  return (
    <div>
      <h1>è£œå®Œãƒ‡ãƒ¼ã‚¿åé›†ç®¡ç†</h1>
      <FailedWorksTable />
      <LocalCollectionTrigger />
      <DataIntegrityChecker />
    </div>
  );
}
```

## ğŸ“Š å®Ÿè£…ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«

### âœ… Phase 1: å¤±æ•—æ¤œå‡ºã‚·ã‚¹ãƒ†ãƒ  (å®Œäº†)
- [x] **FailedWorkTrackerå®Ÿè£…** - `apps/functions/src/services/dlsite/failure-tracker.ts`
- [x] **Cloud Functions ã§ã®å¤±æ•—è¨˜éŒ²å¼·åŒ–** - æ§‹é€ åŒ–ãƒ­ã‚°ãƒ»å¤±æ•—åˆ†é¡ã‚·ã‚¹ãƒ†ãƒ 
- [x] **å¤±æ•—ä½œå“IDç®¡ç†ç”»é¢** - åˆ†æãƒ„ãƒ¼ãƒ« `apps/functions/src/development/analyze-failed-work-ids.ts`
- [x] **å¤±æ•—ç†ç”±åˆ†é¡** - TIMEOUT, NETWORK_ERROR, API_ERROR, REGION_RESTRICTIONç­‰
- [x] **çµ±è¨ˆæƒ…å ±å–å¾—** - ç·å¤±æ•—æ•°ã€å›å¾©æ•°ã€æœªå›å¾©æ•°ã®è‡ªå‹•é›†è¨ˆ
- [x] **è‡ªå‹•ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—** - 30æ—¥çµŒéã—ãŸå›å¾©æ¸ˆã¿è¨˜éŒ²ã®è‡ªå‹•å‰Šé™¤

### âœ… Phase 2: ãƒ­ãƒ¼ã‚«ãƒ«è£œå®Œãƒ„ãƒ¼ãƒ« (å®Ÿè£…å®Œäº†)
- [x] **ãƒ­ãƒ¼ã‚«ãƒ«å®Ÿè¡Œç’°å¢ƒã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—** - é–‹ç™ºç’°å¢ƒã§ã®è£œå®Œåé›†å®Ÿè¡Œæº–å‚™å®Œäº†
- [x] **è£œå®Œåé›†ã‚¹ã‚¯ãƒªãƒ—ãƒˆé–‹ç™º** - `apps/functions/src/development/local-supplement-collector.ts`
- [x] **Cloud Firestore çµ±åˆä¿å­˜** - æˆåŠŸãƒ‡ãƒ¼ã‚¿ã®è‡ªå‹•ä¿å­˜ãƒ»å¤±æ•—è¿½è·¡çµ±åˆ
- [x] **å®Ÿè¡Œã‚¹ã‚¯ãƒªãƒ—ãƒˆ** - `pnpm --filter @suzumina.click/functions local:supplement`
- [x] **å¤±æ•—ä½œå“å›å¾©è¨˜éŒ²** - æˆåŠŸã—ãŸä½œå“IDã®è‡ªå‹•å›å¾©ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹æ›´æ–°
- [x] **ãƒãƒƒãƒå‡¦ç†å¯¾å¿œ** - æœ€å¤§50ä»¶ã®å®‰å…¨ãªä¸¦åˆ—å‡¦ç†

### âœ… Phase 3: é‹ç”¨ã‚·ã‚¹ãƒ†ãƒ  (å®Ÿè£…å®Œäº†)
- [x] **ç›£è¦–ãƒ»é€šçŸ¥ã‚·ã‚¹ãƒ†ãƒ ** - å¤±æ•—ç‡ç›£è¦–ãƒ»ãƒ¡ãƒ¼ãƒ«é€šçŸ¥ã‚·ã‚¹ãƒ†ãƒ å®Œå…¨å®Ÿè£…
- [x] **ãƒ¡ãƒ¼ãƒ«é€šçŸ¥ã‚µãƒ¼ãƒ“ã‚¹** - `apps/functions/src/services/notification/email-service.ts`
- [x] **å¤±æ•—ç‡ç›£è¦–** - `apps/functions/src/services/monitoring/failure-rate-monitor.ts`
- [x] **Cloud Functionsçµ±åˆ** - ç›£è¦–ã‚¢ãƒ©ãƒ¼ãƒˆãƒ»è£œå®Œçµæœé€šçŸ¥ãƒ»é€±æ¬¡ãƒ¬ãƒãƒ¼ãƒˆ
- [x] **å®Ÿè¡Œã‚¹ã‚¯ãƒªãƒ—ãƒˆ** - `pnpm monitor:failure-rate` / `pnpm notify:weekly-report`
- [x] **ãƒ­ãƒ¼ã‚«ãƒ«è£œå®Œé€šçŸ¥** - å®Ÿè¡Œçµæœã®è‡ªå‹•ãƒ¡ãƒ¼ãƒ«é€ä¿¡çµ±åˆ

## ğŸ“ˆ æœŸå¾…åŠ¹æœãƒ»å®Ÿè£…çµæœ

### ãƒ‡ãƒ¼ã‚¿å®Œå…¨æ€§å‘ä¸Š
- **å®Ÿè£…å‰**: 74% (222/300ä»¶)
- **å®Ÿè£…å¾Œ**: **95%+é”æˆå¯èƒ½** (ãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰ã‚·ã‚¹ãƒ†ãƒ ã«ã‚ˆã‚‹è£œå®Œ)
- **ãƒ­ãƒ¼ã‚«ãƒ«è£œå®Œ**: æœ€å¤§50ä»¶/å›ã®åŠ¹ç‡çš„ãªå›å¾©å‡¦ç†

### é‹ç”¨åŠ¹ç‡åŒ– (å®Ÿè£…å®Œäº†)
- âœ… **è‡ªå‹•æ¤œå‡º**: Cloud Functions ã§å¤±æ•—è‡ªå‹•è¨˜éŒ² (`failure-tracker.ts`)
- âœ… **è£œå®Œå®Ÿè¡Œ**: ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒã§ã®åŠ¹ç‡çš„ãªè¿½åŠ åé›† (`local-supplement-collector.ts`)
- âœ… **å®Ÿè¡Œã‚³ãƒãƒ³ãƒ‰**: `pnpm local:supplement` ã§ç°¡å˜å®Ÿè¡Œ
- âœ… **çµ±è¨ˆåˆ†æ**: å®Ÿè¡Œå‰å¾Œã®è©³ç´°ãªå¤±æ•—åˆ†æãƒ»å›å¾©ç‡è¡¨ç¤º

### æ—¥æœ¬ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½“é¨“å‘ä¸Š
- **ã‚³ãƒ³ãƒ†ãƒ³ãƒ„å……å®Ÿ**: æ—¥æœ¬å›½å†…é™å®šä½œå“ã‚‚å«ã‚ãŸå®Œå…¨ãƒ‡ãƒ¼ã‚¿
- **æ¤œç´¢ç²¾åº¦**: å…¨ä½œå“ãƒ‡ãƒ¼ã‚¿ã«ã‚ˆã‚‹é«˜ç²¾åº¦æ¤œç´¢
- **ãƒ¦ãƒ¼ã‚¶ãƒ¼æº€è¶³åº¦**: æ¬ æãƒ‡ãƒ¼ã‚¿ãªã—ã®å®Œå…¨ã‚µãƒ¼ãƒ“ã‚¹

## ğŸ”§ æŠ€è¡“è©³ç´°

### ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼
```
Cloud Functions (è‡ªå‹•åé›†)
    â†“ å¤±æ•—
Failed Work Tracker (è¨˜éŒ²)
    â†“ å®šæœŸå®Ÿè¡Œ
Local Supplement Tool (è£œå®Œåé›†)
    â†“ æˆåŠŸãƒ‡ãƒ¼ã‚¿
Cloud Firestore (çµ±åˆä¿å­˜)
    â†“ æä¾›
Web Application (å®Œå…¨ãƒ‡ãƒ¼ã‚¿è¡¨ç¤º)
```

### å¤±æ•—ãƒ‘ã‚¿ãƒ¼ãƒ³åˆ†é¡
1. **åœ°åŸŸåˆ¶é™**: 26% (ä»Šå›ã®ä¸»è¦å› )
2. **ãƒ¬ãƒ¼ãƒˆåˆ¶é™**: æ¨å®š 5-10%
3. **ä½œå“å›ºæœ‰åˆ¶é™**: æ¨å®š 3-5%
4. **ä¸€æ™‚çš„éšœå®³**: æ¨å®š 2-3%

### ãƒ¢ãƒ‹ã‚¿ãƒªãƒ³ã‚°æŒ‡æ¨™
- **å¤±æ•—ç‡**: ç›®æ¨™ 5% ä»¥ä¸‹
- **è£œå®Œç‡**: å¤±æ•—ä½œå“ã® 90% ä»¥ä¸Šã‚’è£œå®Œ
- **ãƒ‡ãƒ¼ã‚¿æ–°é®®åº¦**: 24æ™‚é–“ä»¥å†…ã®æ›´æ–°

## ğŸ“‹ ã¾ã¨ã‚

ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒã§ã¯æˆåŠŸã™ã‚‹ãŒ Cloud Functions ã§ã¯å¤±æ•—ã™ã‚‹ç¾è±¡ã¯ã€**åœ°åŸŸåˆ¶é™ãŒä¸»è¦å› **ã¨æ¨å®šã•ã‚Œã¾ã™ã€‚

**æ¨å¥¨è§£æ±ºç­–**: ãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰åé›†ã‚·ã‚¹ãƒ†ãƒ 
1. Cloud Functions: é€šå¸¸ã®è‡ªå‹•åé›†ç¶™ç¶š
2. ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒ: å¤±æ•—ä½œå“ã®è£œå®Œåé›†
3. çµ±åˆç®¡ç†: Adminç”»é¢ã§ã®é‹ç”¨ç®¡ç†

ã“ã‚Œã«ã‚ˆã‚Šã€**æ—¥æœ¬å›½å†…ã§é–²è¦§å¯èƒ½ãªå…¨ä½œå“ãƒ‡ãƒ¼ã‚¿**ã‚’ suzumina.click ã§æä¾›ã—ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½“é¨“ã‚’æœ€å¤§åŒ–ã§ãã¾ã™ã€‚